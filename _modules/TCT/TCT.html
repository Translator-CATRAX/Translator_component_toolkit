<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TCT.TCT &#8212; Translator Component Toolkit 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <script src="../../_static/documentation_options.js?v=2709fde1"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for TCT.TCT</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w">  </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ipycytoscape</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ipycytoscape</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>

<span class="c1"># plt.switch_backend(&#39;module://ipykernel.pylab.backend_inline&#39;)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>


<span class="k">def</span><span class="w"> </span><span class="nf">TCT_help</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>

<span class="c1"># list all functions in TCT</span>
<span class="k">def</span><span class="w"> </span><span class="nf">list_functions</span><span class="p">():</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
    <span class="n">functions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="nb">__import__</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="n">functions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">functions</span>
    
<span class="c1"># used. Jan 5, 2024</span>
<div class="viewcode-block" id="get_Translator_APIs">
<a class="viewcode-back" href="../../TCT.html#TCT.TCT.get_Translator_APIs">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_Translator_APIs</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Get a list of Translator APIs from the smart-api.info and return the detailed information for each API in a data frame and the list of API names.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; Translator_KP_info,APInames= TCT.get_SmartAPI_Translator_KP_info() </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">Translator_APIs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1">#Translator_apps_url = &quot;https://smart-api.info/api/query?q=tags.name:translator&amp;fields=info,_meta,tags&amp;meta=1&amp;size=500&quot;</span>
    <span class="n">Translator_apps_url</span> <span class="o">=</span> <span class="s2">&quot;https://dev.smart-api.info/api/query?q=tags.name:translator&amp;fields=info,_meta,tags&amp;meta=1&amp;size=500&quot;</span>
    <span class="n">Translator_apps</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Translator_apps_url</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;hits&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">app</span> <span class="ow">in</span> <span class="n">Translator_apps</span><span class="p">:</span>
        <span class="n">Translator_APIs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">app</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">Translator_APIs</span></div>


<span class="c1"># used May 30, 2025</span>
<span class="c1"># used May 30, 2025</span>
<span class="sd">&quot;&quot;&quot;This is the root URL for the resource.&quot;&quot;&quot;</span>
<span class="n">URL</span> <span class="o">=</span> <span class="s1">&#39;https://smart-api.info/api/query?q=tags.name:translator&#39;</span>

<div class="viewcode-block" id="get_SmartAPI_Translator_KP_info">
<a class="viewcode-back" href="../../TCT.html#TCT.TCT.get_SmartAPI_Translator_KP_info">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_SmartAPI_Translator_KP_info</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the SmartAPI Translator KP info from the smart-api.info API.</span>
<span class="sd">    Returns a DataFrame with the SmartAPI Translator KP info.</span>

<span class="sd">    </span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; Translator_KP_info,APInames = get_SmartAPI_Translator_KP_info(&#39;AML&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

    <span class="c1"># several APIs should be excluded:</span>
    <span class="c1">#https://smart-api.info/ui/ac9c2ad11c5c442a1a1271223468ced1</span>

    <span class="c1"># Get x-bte smartapi specs</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://smart-api.info/api/query?q=tags.name:translator AND tags.name:trapi&amp;size=1000&amp;sort=_seq_no&amp;raw=1&amp;fields=paths,servers,tags,components.x-bte*,info,_meta&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error downloading smartapi specs: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">()</span>

    <span class="n">content</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="n">smartapis</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="s2">&quot;hits&quot;</span><span class="p">]</span>

    <span class="n">id_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">title_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">prod_url_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ci_url_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">test_url_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">api</span> <span class="ow">in</span> <span class="n">smartapis</span><span class="p">:</span>
        
        
        <span class="n">ci_found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">test_found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">prod_found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">api</span><span class="p">[</span><span class="s1">&#39;servers&#39;</span><span class="p">])):</span>
            
            <span class="n">server</span> <span class="o">=</span> <span class="n">api</span><span class="p">[</span><span class="s1">&#39;servers&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;x-maturity&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">server</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping server without x-maturity: </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;x-maturity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;production&#39;</span><span class="p">:</span>
                    <span class="c1"># if prod_ur is not ars-prod.transltr.io</span>
                    <span class="k">if</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;https://ars-prod.transltr.io&#39;</span><span class="p">:</span>
                        <span class="n">prod_url</span> <span class="o">=</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/ars/api/submit/&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># if prod_url does not end with /, add &#39;/query/&#39; to the end</span>
                        <span class="k">if</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
                            <span class="n">prod_url</span> <span class="o">=</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;query/&#39;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># if prod_url does not end with /, add &#39;/query/&#39; to the end</span>
                            <span class="n">prod_url</span> <span class="o">=</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/query/&#39;</span>
                    
                    <span class="n">prod_found</span> <span class="o">=</span> <span class="kc">True</span>
                
                <span class="k">if</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;x-maturity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;staging&#39;</span> <span class="ow">or</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;x-maturity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;development&#39;</span><span class="p">:</span>
                    <span class="c1"># if ci_url is not ars.ci.transltr.io</span>
                    <span class="k">if</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;https://ars.ci.transltr.io&#39;</span><span class="p">:</span>
                        <span class="n">ci_url</span> <span class="o">=</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/ars/api/submit/&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># if ci_url does not end with /, add &#39;/query/&#39; to the end</span>
                        <span class="k">if</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
                            <span class="n">ci_url</span> <span class="o">=</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;query/&#39;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># if ci_url does not end with /, add &#39;/query/&#39; to the end</span>
                            <span class="n">ci_url</span> <span class="o">=</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/query/&#39;</span>
                    <span class="n">ci_found</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="k">if</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;x-maturity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;testing&#39;</span><span class="p">:</span>
                    <span class="c1"># if test_url is not ars-test.transltr.io</span>
                    <span class="k">if</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;https://ars.test.transltr.io&#39;</span><span class="p">:</span>
                        <span class="n">test_url</span> <span class="o">=</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/ars/api/submit/&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># if test_url does not end with /, add &#39;/query/&#39; to the end</span>
                        <span class="k">if</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
                            <span class="n">test_url</span> <span class="o">=</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;query/&#39;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># if test_url does not end with /, add &#39;/query/&#39; to the end</span>
                            <span class="n">test_url</span> <span class="o">=</span> <span class="n">server</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/query/&#39;</span>

                    <span class="n">test_found</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">prod_found</span> <span class="ow">or</span> <span class="n">ci_found</span> <span class="ow">or</span> <span class="n">test_found</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">api</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping server without production, staging or testing: </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">id_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;https://smart-api.info/ui/&#39;</span><span class="o">+</span><span class="n">api</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">])</span>
            <span class="n">title_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">api</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">prod_found</span><span class="p">:</span>
                <span class="n">prod_url_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod_url</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prod_url</span> <span class="o">=</span> <span class="n">prod_url_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">ci_found</span><span class="p">:</span>
                <span class="n">ci_url_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ci_url</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ci_url</span> <span class="o">=</span> <span class="n">ci_url_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">test_found</span><span class="p">:</span>
                <span class="n">test_url_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_url</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">test_url</span> <span class="o">=</span> <span class="n">test_url_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                
    <span class="c1"># write all the smartapis to a dataframe</span>

    <span class="n">smartapi_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">id_list</span><span class="p">,</span>
        <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">title_list</span><span class="p">,</span>
        <span class="s1">&#39;prod_url&#39;</span><span class="p">:</span> <span class="n">prod_url_list</span><span class="p">,</span>
        <span class="s1">&#39;ci_url&#39;</span><span class="p">:</span> <span class="n">ci_url_list</span><span class="p">,</span>
        <span class="s1">&#39;test_url&#39;</span><span class="p">:</span> <span class="n">test_url_list</span><span class="p">,</span>
    <span class="p">})</span>
    <span class="c1">#smartapi_df = smartapi_df.set_index(&#39;id&#39;)</span>

    <span class="c1"># remove the excluded APIs from the dataframe</span>
    <span class="c1">#excluded_APIs = [&#39;https://smart-api.info/ui/ac9c2ad11c5c442a1a1271223468ced1&#39;,#RaMP]</span>
    
    <span class="c1">#smartapi_df = smartapi_df[~smartapi_df[&#39;id&#39;].isin(excluded_APIs)]</span>

    <span class="n">API_names</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">smartapi_df</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">prod_url_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1">#API_names[smartapi_df[&#39;title&#39;][i]] = smartapi_df[&#39;prod_url&#39;][i] + &#39;query/&#39;</span>
            <span class="n">API_names</span><span class="p">[</span><span class="n">smartapi_df</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">prod_url_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">API_names</span><span class="p">[</span><span class="n">smartapi_df</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ci_url_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 
    <span class="k">return</span> <span class="n">smartapi_df</span><span class="p">,</span> <span class="n">API_names</span></div>


<span class="c1"># used Dec 5, 2023 (Example_query_one_hop_with_category.ipynb)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">list_Translator_APIs</span><span class="p">():</span>
    <span class="n">APInames</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Sri-name-resolver&#39;</span><span class="p">:</span><span class="s1">&#39;https://name-lookup.ci.transltr.io/query/&#39;</span><span class="p">,</span> <span class="c1">#https://smart-api.info/ui/9995fed757acd034ef099dbb483c4c82 </span>
            <span class="c1">#&#39;Monarch API&#39;:&#39;https://api-v3.monarchinitiative.org/query/&#39; #https://smart-api.info/ui/d22b657426375a5295e7da8a303b9893</span>
            <span class="c1">#Complex Portal Web Service : #https://smart-api.info/ui/326eb1e437303bee27d3cef29227125d</span>
            <span class="s1">&#39;Sri-answer-appraiser(Trapi v1.5.0)&#39;</span><span class="p">:</span><span class="s1">&#39;https://answerappraiser.renci.org/get_appraisal/&#39;</span><span class="p">,</span> <span class="c1">#https://smart-api.info/ui/6dcc5454fe4e0095090d8a956781c438</span>
            <span class="c1">#LitVar API : dca415f2d792976af9d642b7e73f7a41</span>
            <span class="c1">#CTD API : 0212611d1c670f9107baf00b77f0889a</span>
            <span class="c1">#EBI Proteins API : 43af91b3d7cae43591083bff9d75c6dd</span>
            <span class="c1">#Ontology Lookup Service API : 1c056ffc7ed0dd1229e71c4752239465</span>
            <span class="s1">&#39;Cqs(Trapi v1.5.0)&#39;</span><span class="p">:</span><span class="s1">&#39;https://cqs-dev.apps.renci.org/query/&#39;</span><span class="p">,</span> <span class="c1">#https://smart-api.info/ui/c359a127dc8824d90cef436d3dce71d4</span>
            <span class="s1">&#39;Workflow-runner(Trapi v1.5.0)&#39;</span><span class="p">:</span><span class="s1">&#39;https://translator-workflow-runner.renci.org/query/&#39;</span><span class="p">,</span> <span class="c1">#https://smart-api.info/ui/6a3507ad6f709844d1b2b89691898a93</span>
            <span class="s1">&#39;Automat-monarchinitiative(Trapi v1.5.0)&#39;</span><span class="p">:</span><span class="s1">&#39;https://automat.ci.transltr.io/monarch-kg/query/&#39;</span><span class="p">,</span><span class="c1">#https://smart-api.info/ui/6b88f83127513bd350e6962218ea84f4</span>
            <span class="c1">#QuickGO API : 1f277e1563fcfd124bfae2cc3c4bcdec</span>
            <span class="c1">#RaMP API v1.0.1 : ac9c2ad11c5c442a1a1271223468ced1 # need to check carefully.</span>
            <span class="s1">&#39;Connections Hypothesis Provider API&#39;</span><span class="p">:</span><span class="s1">&#39;https://chp-api.transltr.io/query/&#39;</span><span class="p">,</span> <span class="c1">#https://smart-api.info/ui/412af63e15b73e5a30778aac84ce313f</span>
            <span class="s1">&#39;Automat-genome-alliance(Trapi v1.5.0)&#39;</span> <span class="p">:</span><span class="s1">&#39;https://automat.ci.transltr.io/genome-alliance/query/&#39;</span><span class="p">,</span> <span class="c1">#https://smart-api.info/ui/b4c868db33b95b4890faeeefd5800552</span>
            <span class="s1">&#39;mediKanren&#39;</span> <span class="p">:</span> <span class="s1">&#39;https://medikanren-trapi.transltr.io/query/&#39;</span><span class="p">,</span> <span class="c1">#https://smart-api.info/ui/c563a58be4aacb68d10ba0ceb6b52255</span>
            <span class="s1">&#39;Automat-hgnc(Trapi v1.5.0)&#39;</span><span class="p">:</span><span class="s1">&#39;https://automat.transltr.io/hgnc/query/&#39;</span><span class="p">,</span> <span class="c1">#&#39;https://smart-api.info/ui/8671309d2b94e413a4c1f9a9f82e4660&#39;</span>
            <span class="s1">&#39;Automat-hmdb(Trapi v1.5.0)&#39;</span><span class="p">:</span><span class="s1">&#39;https://automat.transltr.io/hmdb/query/&#39;</span> <span class="p">,</span><span class="c1"># 0a1c0f46f4950b82b1aa7dad27aad10a</span>
            <span class="s1">&#39;Automat-gwas-catalog(Trapi v1.5.0)&#39;</span> <span class="p">:</span><span class="s1">&#39;https://automat.transltr.io/gwas-catalog/query/&#39;</span><span class="p">,</span> <span class="c1">#349fed5531c094c33f10c071efe9d0de</span>
            <span class="s1">&#39;Automat-gtopdb(Trapi v1.5.0)&#39;</span><span class="p">:</span> <span class="s1">&#39;https://automat.transltr.io/gtopdb/query/&#39;</span><span class="p">,</span><span class="c1"># 759df287a21c30cd514df323be02a84b</span>
            <span class="s1">&#39;Autonomous Relay System (ARS) TRAPI&#39;</span> <span class="p">:</span> <span class="s1">&#39;https://ars-prod.transltr.io/ars/api/submit/&#39;</span><span class="p">,</span> <span class="c1">#4c12efd48ced755ac4b72b1922202ec2</span>
            <span class="s1">&#39;Automat-robokop(Trapi v1.5.0)&#39;</span> <span class="p">:</span> <span class="s1">&#39;https://automat.transltr.io/robokopkg/query/&#39;</span><span class="p">,</span><span class="c1"># 4f9c8853b721ef1f14ecee6d92fc19b5</span>
            <span class="s1">&#39;Automat-binding-db(Trapi v1.5.0)&#39;</span><span class="p">:</span> <span class="s1">&#39;https://automat.transltr.io/binding-db/query/&#39;</span><span class="p">,</span> <span class="c1">#a9d6ee341d8ea4c7d3ae9ed0941cb274</span>
            <span class="s1">&#39;Automat-ehr-may-treat-kp(Trapi v1.5.0)&#39;</span> <span class="p">:</span> <span class="s1">&#39;https://automat.renci.org/ehr-may-treat-kp/query/&#39;</span><span class="p">,</span><span class="c1">#eb4e66886fe5c178ae41977cea2c6307</span>
            <span class="c1">#Automat-gtex(Trapi v1.5.0) : eef72049e4e01c020b7799f711e0e65b,</span>
            <span class="c1">#Automat-pharos(Trapi v1.5.0) : 1f057c53d42694686369f0e542f965c6</span>
            <span class="c1">#Automat-reactome(Trapi v1.5.0) : 61b41c5d9b90eb8ad16e037f9a87d593</span>
            <span class="c1">#Sri-node-normalizer(Trapi v1.5.0) : 1c2eb8d02b4796c6a657c3363c0657dc</span>
            <span class="c1">#Automat-human-goa(Trapi v1.5.0) : cb7a43d444cb3dcbe8e3c78d314334cf</span>
            <span class="c1">#Automat-cam-kp(Trapi v1.5.0) : 7ab0209ea8590341d8e5d0166cac3d2f</span>
            <span class="c1">#Automat-viral-proteome(Trapi v1.5.0) : 2aca41fc6c3dc426ec6583d42603be02</span>
            <span class="c1">#Aragorn(Trapi v1.5.0) : 1dad992a6ce8f680e59a5ea09d90670d</span>
            <span class="c1">#Automat-drug-central(Trapi v1.5.0) : 673b9fc76973dfa5fe3ed151fdbfc807</span>
            <span class="c1">#Automat-ubergraph(Trapi v1.5.0) : dde0552a37fc136526216148ff7594a0</span>
            <span class="c1">#Automat-string-db(Trapi v1.5.0) : 7984a621a28c109c5c09f65fed0e7ea7</span>
            <span class="c1">#Automat-hetionet(Trapi v1.5.0) : a5fe24f987331b58191e67598118f369</span>
            <span class="c1">#Automat-ctd(Trapi v1.5.0) : f82c01b15c46e024212c1a3271aaef0b</span>
            <span class="c1">#Automat-intact(Trapi v1.5.0) : b4023595664163e0aec5e825da150e16</span>
            <span class="c1">#Automat-ehr-clinical-connections-kp(Trapi v1.5.0) : 6f4dd91bc56fce4f597bc44153cf418e</span>
            <span class="c1">#Automat-icees-kg(Trapi v1.5.0) : c64d583402f21cc85810d33befe49c86</span>
            <span class="c1">#Automat-panther(Trapi v1.5.0) : 3f78d3fb8a7a577fbc7cc0a913ac3fc5</span>
            <span class="c1">#Biolink Lookup : 02f84c50043e94970316568439b7b384</span>
            <span class="s1">&#39;COHD TRAPI&#39;</span> <span class="p">:</span> <span class="s1">&#39;https://cohd-api.transltr.io/api/query/&#39;</span><span class="p">,</span> <span class="c1">##d4290b6b5741e6da6cc6a6f42e0cfdb5</span>
            <span class="c1">#&#39;Text Mined Cooccurrence API&#39; : &quot;https://cooccurence.ci.transltr.io/query/&quot;, #aa9c668df9d217409891cc7afb7ac039</span>
            <span class="s1">&#39;Text Mined Cooccurrence API&#39;</span> <span class="p">:</span> <span class="s2">&quot;https//cooccurrence.transltr.io/query&quot;</span><span class="p">,</span> <span class="c1">#71fa2e0f0f1fe1ec67f4ddb719db5ef3</span>
            <span class="c1">#BioThings Rhea API : 03283cc2b21c077be6794e1704b1d230</span>
            <span class="c1">#SmartAPI API : 27a5b60716c3a401f2c021a5b718c5b1</span>
            <span class="c1">#MyDisease.info API : 671b45c0301c8624abbd26ae78449ca2</span>
            <span class="c1">#MyVariant.info API : 09c8782d9f4027712e65b95424adba79</span>
            <span class="c1">#BioThings UBERON API : ec6d76016ef40f284359d17fbf78df20</span>
            <span class="c1">#OpenPredict API : 025600054bd8d6fb14ee66ee9d4a9830</span>
            <span class="c1">#MyGene.info API : 59dce17363dce279d389100834e43648</span>
            <span class="c1">#Answer-coalesce(Trapi v1.5.0) : fe8bb783ff710ab4e176f38c5f7777af</span>
            <span class="c1">#BioThings HPO API : a5b0ec6bfde5008984d4b6cde402d61f</span>
            <span class="c1">#Drug Approvals KP - TRAPI 1.5.0 : edc04feaf16c12424737988ce2e90d60</span>
            <span class="c1">#Gene-List Network Enrichment Analysis : 5c8740542b4444d4f85c2e23c670b952</span>
            <span class="c1">#MolePro : 1901bab8d33bb70b124f400ec1cfdba3</span>
            <span class="c1">#Multiomics KP - TRAPI 1.5.0 : 1b6de23ed3c4e0713b20794477ba1e39</span>
            <span class="c1">#Microbiome KP - TRAPI 1.5.0 : a8be4ea3fe8fa80a952ead0b3c5e4bc1</span>
            <span class="c1">#BioThings GO Biological Process API : cc857d5b7c8b7609b5bbb38ff990bfff</span>
            <span class="c1">#imProving Agent for TRAPI 1.5 : 415c3b1a85ead4ceb58caf00dee9b24e</span>
            <span class="c1">#Clinical Trials KP - TRAPI 1.5.0 : e51073371d7049b9643e1edbdd61bcbd</span>
            <span class="c1">#BioThings EBIgene2phenotype API : 1f47552dabd67351d4c625adb0a10d00</span>
            <span class="c1">#BioThings RARe-SOURCE API : b772ebfbfa536bba37764d7fddb11d6f</span>
            <span class="c1">#PharmGKB REST API : bde72db681ec0b8f9eeb67bb6b8dd72c</span>
            <span class="c1">#BioThings DDInter API : 00fb85fc776279163199e6c50f6ddfc6</span>
            <span class="c1">#MyChem.info API : 8f08d1446e0bb9c2b323713ce83e2bd3</span>
            <span class="c1">#BioThings BindingDB API : 38e9e5169a72aee3659c9ddba956790d</span>
            <span class="c1">#BioThings PFOCR API : edeb26858bd27d0322af93e7a9e08761</span>
            <span class="c1">#BioThings MGIgene2phenotype API : 77ed27f111262d0289ed4f4071faa619</span>
            <span class="c1">#BioThings FooDB API : f1b8f64c316a01d1722f0fb842499fe5</span>
            <span class="c1">#Genetics Data Provider for NCATS Biomedical Translator Reasoners : db981dff8d93dcb0cfab5dbee8afbb40</span>
            <span class="c1">#BioThings GO Molecular Function API : 34bad236d77bea0a0ee6c6cba5be54a6</span>
            <span class="c1">#BioThings BioPlanet Pathway-Disease API : 55a223c6c6e0291dbd05f2faf27d16f4</span>
            <span class="c1">#BioThings DISEASES API : a7f784626a426d054885a5f33f17d3f8</span>
            <span class="c1">#BioThings BioPlanet Pathway-Gene API : b99c6dd64abcefe87dcd0a51c249ee6d</span>
            <span class="c1">#BioThings GO Cellular Component API : f339b28426e7bf72028f60feefcd7465</span>
            <span class="c1">#SPOKE KP for TRAPI 1.5 : 7f70cdfaeb801501da08dacc294e8b9f</span>
            <span class="c1">#BioThings IDISK API : 32f36164fabed5d3abe6c2fd899c9418</span>
            <span class="c1">#BioThings FoodData Central API : 895ec14a3650ec7ad85959a2d1554e2f</span>
            <span class="c1">#BioThings AGR API : 68f12100e74342ae0dd5013d5f453194</span>
            <span class="c1">#Translator Annotation Service : 5a4c41bf2076b469a0e9cfcf2f2b8f29</span>
            <span class="c1">#BioThings InnateDB API : e9eb40ff7ad712e4e6f4f04b964b5966</span>
            <span class="c1">#BioThings repoDB API : 1138c3297e8e403b6ac10cff5609b319</span>
            <span class="c1">#BioThings GTRx API : 316eab811fd9ef1097df98bcaa9f7361</span>
            <span class="c1">#BioThings Explorer (BTE) TRAPI : dc91716f44207d2e1287c727f281d339</span>
            <span class="c1">#RTX KG2 - TRAPI 1.5.0 : a6b575139cfd429b0a87f825a625d036</span>
            <span class="c1">#BioThings SuppKG API : b48c34df08d16311e3bca06b135b828d</span>
            <span class="c1">#Knowledge Collaboratory API : 8601da411b8681dbbc32239ceb0f1a55</span>
            <span class="c1">##Service Provider TRAPI : 36f82f05705c317bac17ddae3a0ea2f0</span>
            <span class="c1">#Multiomics EHR Risk KP API : d86a24f6027ffe778f84ba10a7a1861a</span>
            <span class="c1">#Multiomics Wellness KP API : 02af7d098ab304e80d6f4806c3527027</span>
            <span class="c1">#BioThings DGIdb API : e3edd325c76f2992a111b43a907a4870</span>
            <span class="c1">#BioThings SEMMEDDB API : 1d288b3a3caf75d541ffaae3aab386c8</span>
            <span class="s1">&#39;Multiomics BigGIM-DrugResponse KP API&#39;</span> <span class="p">:</span> <span class="s1">&#39;https://biothings.ci.transltr.io/biggim_drugresponse_kg/query/&#39;</span><span class="p">,</span> <span class="c1">#adf20dd6ff23dfe18e8e012bde686e31</span>
            <span class="c1">#Biothings Therapeutic Target Database API : e481efd21f8e8c1deac05662439c2294</span>
            <span class="c1">#Text Mining Targeted Association API : 978fe380a147a8641caf72320862697b</span>
           <span class="s1">&#39;ARAX Translator Reasoner - TRAPI 1.5.0&#39;</span> <span class="p">:</span> <span class="s1">&#39;https://arax.transltr.io/api/arax/v1.4/query/&#39;</span><span class="p">,</span> <span class="c1"># 03e63fbd5ed251bce08cb5801b6b169b</span>

        <span class="s1">&#39;Automat-ctd(Trapi v1.4.0)&#39;</span><span class="p">:</span><span class="s2">&quot;https://automat.transltr.io/ctd/1.4/query&quot;</span><span class="p">,</span>
        <span class="c1">#&#39;Automat-sri-reference-kg(Trapi v1.4.0)&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;Autonomous Relay System (ARS) TRAPI&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;BioLink API&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;BioThings AGR API&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;BioThings BioPlanet Pathway-Gene API&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;BioThings DDInter API&#39;:&quot;&quot;,</span>
        <span class="s1">&#39;BioThings Explorer (BTE) TRAPI&#39;</span><span class="p">:</span><span class="s2">&quot;https://bte.transltr.io/v1/query&quot;</span><span class="p">,</span>
        <span class="c1">#&#39;BioThings FooDB API&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;BioThings FoodData Central API&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;BioThings GO Biological Process API&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;BioThings InnateDB API&#39;:&quot;&quot;, # not in TRAPI standard</span>
        <span class="c1">#&#39;BioThings RARe-SOURCE API&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;BioThings repoDB API&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;Biolink Lookup&#39;:&quot;&quot;,</span>
        <span class="s1">&#39;Biothings Therapeutic Target Database API&#39;</span><span class="p">:</span><span class="s2">&quot;https://biothings.ncats.io/ttd/query&quot;</span><span class="p">,</span>
        <span class="c1">#&#39;COHD TRAPI&#39;:&quot;https://cohd-api.transltr.io/api/query&quot;,</span>
        <span class="c1">#&#39;Complex Portal Web Service&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;Curated Query Service&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;EBI Proteins API&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;Gene-List Network Enrichment Analysis&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;Knowledge Collaboratory API&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;LitVar API&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;RaMP API v1.0.1&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;SmartAPI API&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;Sri-answer-appraiser(Trapi v1.4.0)&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;Sri-name-resolver&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;Sri-node-normalizer(Trapi v1.3.0)&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;Sri-node-normalizer(Trapi v1.4.0)&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;Translator Annotation Service&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;Workflow-runner(Trapi v1.4.0)&#39;:&quot;https://translator-workflow-runner.transltr.io/query&quot;,</span>
        <span class="c1">#&#39;imProving Agent for TRAPI 1.4&#39;:&quot;&quot;,</span>
        <span class="c1">#&#39;mediKanren&#39;:&#39;https://medikanren-trapi.transltr.io/query&#39;, #ARA</span>
        <span class="c1">#&quot;BigGIM_BMG&quot;:&quot;http://127.0.0.1:8000/find_path_by_predicate&quot;,</span>
        <span class="s2">&quot;Aragorn(Trapi v1.4.0)&quot;</span><span class="p">:</span><span class="s2">&quot;https://aragorn.transltr.io/aragorn/query&quot;</span><span class="p">,</span>
        <span class="c1">#&quot;ARAX Translator Reasoner - TRAPI 1.4.0&quot;:&quot;https://arax.transltr.io/api/arax/v1.4/asyncquery&quot;,</span>
        <span class="s2">&quot;ARAX Translator Reasoner - TRAPI 1.4.0&quot;</span><span class="p">:</span><span class="s2">&quot;https://arax.transltr.io/api/arax/v1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RTX KG2 - TRAPI 1.4.0&quot;</span><span class="p">:</span><span class="s2">&quot;https://arax.ncats.io/api/rtxkg2/v1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SPOKE KP for TRAPI 1.4&quot;</span><span class="p">:</span><span class="s2">&quot;https://spokekp.transltr.io/api/v1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Multiomics BigGIM-DrugResponse KP API&quot;</span><span class="p">:</span><span class="s2">&quot;https://bte.transltr.io/v1/smartapi/adf20dd6ff23dfe18e8e012bde686e31/query&quot;</span><span class="p">,</span>
        <span class="c1">#&quot;Multiomics BigGIM-DrugResponse KP API&quot;:&quot;https://bte.test.transltr.io/v1/smartapi/adf20dd6ff23dfe18e8e012bde686e31/query&quot;,</span>
        <span class="s2">&quot;Multiomics ClinicalTrials KP&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/d86a24f6027ffe778f84ba10a7a1861a/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Multiomics Wellness KP API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/02af7d098ab304e80d6f4806c3527027/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Multiomics EHR Risk KP API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/d86a24f6027ffe778f84ba10a7a1861a/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Biothings Explorer (BTE)&quot;</span><span class="p">:</span><span class="s2">&quot;https://bte.transltr.io/v1/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Service Provider TRAPI&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/978fe380a147a8641caf72320862697b/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Explanatory-agent&quot;</span><span class="p">:</span><span class="s2">&quot;https://explanatory-agent-creative.azurewebsites.net/ARA/v1.3/asyncquery&quot;</span><span class="p">,</span> <span class="c1">#403 error</span>
        <span class="s2">&quot;MolePro&quot;</span><span class="p">:</span><span class="s2">&quot;https://translator.broadinstitute.org/molepro/trapi/v1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Genetics KP&quot;</span><span class="p">:</span><span class="s2">&quot;https://genetics-kp.transltr.io/genetics_provider/trapi/v1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;medikanren-unsecret&quot;</span><span class="p">:</span><span class="s2">&quot;https://medikanren-trapi.transltr.io/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Text Mined Cooccurrence API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/978fe380a147a8641caf72320862697b/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;OpenPredict API&quot;</span><span class="p">:</span><span class="s2">&quot;https://openpredict.transltr.io/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Agrkb(Trapi v1.4.0)&quot;</span><span class="p">:</span><span class="s2">&quot;https://automat.transltr.io/genome-alliance/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-biolink(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.renci.org/biolink/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-cam-kp(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.ci.transltr.io/cam-kp/1.4/query?limit=100&quot;</span><span class="p">,</span>
        <span class="c1">#&quot;Automat-ctd(Trapi v1.4.0)&quot;: &quot;https://automat.renci.org/drugcentral/1.4/query&quot;,</span>
        <span class="s2">&quot;Automat-drug-central(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.ci.renci.org/drugcentral/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-gtex(Trapi v1.4.0)&quot;</span><span class="p">:</span><span class="s2">&quot;https://automat.renci.org/gtex/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-gtopdb(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.renci.org/gtopdb/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-gwas-catalog(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.renci.org/gwas-catalog/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-hetio(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.ci.transltr.io/hetio/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-hgnc(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.renci.org/hgnc/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-hmdb(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.renci.org/hmdb/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-human-goa(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.renci.org/human-goa/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-icees-kg(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.renci.org/icees-kg/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-intact(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.renci.org/intact/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-panther(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.renci.org/panther/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-pharos(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.renci.org/pharos/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-robokop(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://ars-prod.transltr.io/ara-robokop/api/runquery&quot;</span><span class="p">,</span> <span class="c1">#doesn&#39;t work</span>
        <span class="s2">&quot;Automat-sri-reference-kp(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.ci.transltr.io/sri-reference-kp/1.4/query&quot;</span><span class="p">,</span> <span class="c1">#doesn&#39;t work</span>
        <span class="s2">&quot;Automat-string-db(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.ci.transltr.io/string-db/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-ubergraph(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.ci.transltr.io/ubergraph/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-ubergraph-nonredundant(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.ci.transltr.io/ubergraph-nonredundant/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Automat-viral-proteome(Trapi v1.4.0)&quot;</span><span class="p">:</span> <span class="s2">&quot;https://automat.ci.transltr.io/viral-proteome/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CTD API&quot;</span><span class="p">:</span><span class="s2">&quot;https://automat.ci.transltr.io/ctd/1.4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Connections Hypothesis Provider API&quot;</span><span class="p">:</span><span class="s2">&quot;https://chp-api.transltr.io/query&quot;</span><span class="p">,</span> <span class="c1">#no knowledge_graph is defined in the response</span>
        <span class="s2">&quot;MyGene.info API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/59dce17363dce279d389100834e43648/query&quot;</span><span class="p">,</span> <span class="c1">#check with chunlei</span>
        <span class="s2">&quot;MyDisease.info API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/671b45c0301c8624abbd26ae78449ca2/query&quot;</span><span class="p">,</span> <span class="c1">#check with chunlei</span>
        <span class="s2">&quot;MyChem.info API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/8f08d1446e0bb9c2b323713ce83e2bd3/query&quot;</span><span class="p">,</span> <span class="c1">#check with chunlei</span>
        <span class="s2">&quot;MyVariant.info API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/59dce17363dce279d389100834e43648/query&quot;</span><span class="p">,</span> <span class="c1">#check with chunlei</span>
        <span class="s2">&quot;Ontology Lookup Service API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/1c056ffc7ed0dd1229e71c4752239465/query&quot;</span><span class="p">,</span> <span class="c1">#check with chunlei</span>
        <span class="s2">&quot;PharmGKB REST API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/bde72db681ec0b8f9eeb67bb6b8dd72c/query&quot;</span><span class="p">,</span> <span class="c1">#need to check with chunlei/Andrew</span>
        <span class="s2">&quot;QuickGO API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/1f277e1563fcfd124bfae2cc3c4bcdec/query&quot;</span><span class="p">,</span><span class="c1">#pathways</span>
        <span class="c1">#&quot;RaMP API v1.0.1&quot;:&quot;&quot;,</span>
        <span class="s2">&quot;Text Mining Targeted Association API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/978fe380a147a8641caf72320862697b/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings BindingDB API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/38e9e5169a72aee3659c9ddba956790d/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings BioPlanet Pathway-Disease API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/55a223c6c6e0291dbd05f2faf27d16f4/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings DDinter API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/00fb85fc776279163199e6c50f6ddfc6/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings DGIdb API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/e3edd325c76f2992a111b43a907a4870/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings DISEASES API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/a7f784626a426d054885a5f33f17d3f8/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings EBIgene2phenotype API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/1f47552dabd67351d4c625adb0a10d00/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings Biological Process API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/cc857d5b7c8b7609b5bbb38ff990bfff/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings GO Cellular Component API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/f339b28426e7bf72028f60feefcd7465/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings GO Molecular Function API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/34bad236d77bea0a0ee6c6cba5be54a6/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings GTRx API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/316eab811fd9ef1097df98bcaa9f7361/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings HPO API&quot;</span><span class="p">:</span> <span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/d7d1cc9bbe04ad9936076ca5aea904fe/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings IDISK API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/32f36164fabed5d3abe6c2fd899c9418/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings MGIgene2phenotype API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/77ed27f111262d0289ed4f4071faa619/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings PFOCR API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/edeb26858bd27d0322af93e7a9e08761/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Biothings RARe-SOURCE API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/b772ebfbfa536bba37764d7fddb11d6f/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings Rhea API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/03283cc2b21c077be6794e1704b1d230/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings SEMMEDDB API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/1d288b3a3caf75d541ffaae3aab386c8/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings SuppKG API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/b48c34df08d16311e3bca06b135b828d/query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BioThings UBERON API&quot;</span><span class="p">:</span><span class="s2">&quot;https://api.bte.ncats.io/v1/smartapi/ec6d76016ef40f284359d17fbf78df20/query&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span><span class="p">(</span><span class="n">APInames</span><span class="p">)</span>






<span class="c1"># used. Dec 5, 2023 (Example_query_one_hop_with_category.ipynb)</span>
<div class="viewcode-block" id="select_API">
<a class="viewcode-back" href="../../TCT.html#TCT.TCT.select_API">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">select_API</span><span class="p">(</span><span class="n">sub_list</span><span class="p">,</span><span class="n">obj_list</span><span class="p">,</span> <span class="n">metaKG</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    selects the APIs that can connect the given subject and object categories in the meta knowledge graph.</span>
<span class="sd">    </span>
<span class="sd">    sub_list = [&quot;biolink:Gene&quot;, &quot;biolink:Protein&quot;]</span>
<span class="sd">    obj_list = [&quot;biolink:Gene&quot;, &quot;biolink:Disease&quot;]</span>

<span class="sd">    ---------</span>
<span class="sd">    Example:</span>
<span class="sd">    &gt;&gt;&gt; sub_list = [&quot;biolink:Gene&quot;, &quot;biolink:Protein&quot;]</span>
<span class="sd">    &gt;&gt;&gt; obj_list = [&quot;biolink:Gene&quot;, &quot;biolink:Disease&quot;]</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; Translator_KP_info,APInames= translator_kpinfo.get_translator_kp_info()</span>
<span class="sd">    &gt;&gt;&gt; print(len(Translator_KP_info))</span>
<span class="sd">    &gt;&gt;&gt; metaKG = translator_metakg.get_KP_metadata(APInames) </span>
<span class="sd">    &gt;&gt;&gt; print(metaKG.shape)</span>
<span class="sd">    &gt;&gt;&gt; APInames,metaKG = translator_metakg.add_plover_API(APInames, metaKG)</span>
<span class="sd">    &gt;&gt;&gt; selected_apis = select_API(sub_list, obj_list, metaKG)</span>
<span class="sd">    &gt;&gt;&gt; print(selected_apis)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">new_sub_list</span> <span class="o">=</span> <span class="n">sub_list</span>
    <span class="n">new_obj_list</span> <span class="o">=</span> <span class="n">obj_list</span>
    <span class="c1">#for item in sub_list:</span>
    <span class="c1">#    new_sub_list.append(item.split(&quot;:&quot;)[1])</span>
    <span class="c1">#for item in obj_list:</span>
    <span class="c1">#    new_obj_list.append(item.split(&quot;:&quot;)[1])</span>

    <span class="c1">#metaKG = pd.read_csv(&quot;KP_metadata.csv&quot;)</span>
    <span class="n">df1</span> <span class="o">=</span> <span class="n">metaKG</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">new_sub_list</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">new_obj_list</span><span class="p">))]</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">metaKG</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">new_obj_list</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">new_sub_list</span><span class="p">))]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">])</span>
    <span class="k">return</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;API&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span></div>




<span class="c1"># used. Dec 5, 2023  (Example_query_one_hop_with_category.ipynb)</span>
<div class="viewcode-block" id="select_concept">
<a class="viewcode-back" href="../../TCT.html#TCT.TCT.select_concept">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">select_concept</span><span class="p">(</span><span class="n">sub_list</span><span class="p">,</span><span class="n">obj_list</span><span class="p">,</span><span class="n">metaKG</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Selects the predicates connecting the given subject and object categories in the meta knowledge graph.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">#result_df = pd.read_csv(&quot;KP_metadata.csv&quot;)</span>
    <span class="n">df1</span> <span class="o">=</span> <span class="n">metaKG</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sub_list</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">obj_list</span><span class="p">))]</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">metaKG</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">obj_list</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sub_list</span><span class="p">))]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">])</span>
    <span class="k">return</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Predicate&#39;</span><span class="p">])))</span></div>

<div class="viewcode-block" id="sele_predicates_API">
<a class="viewcode-back" href="../../TCT.html#TCT.TCT.sele_predicates_API">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sele_predicates_API</span><span class="p">(</span><span class="n">input_node1_category</span><span class="p">,</span><span class="n">input_node2_category</span><span class="p">,</span><span class="n">metaKG</span><span class="p">,</span> <span class="n">APInames</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Selects predicates, APIs, and API URLs for the given input node categories.</span>

<span class="sd">    -----------</span>
<span class="sd">    Example:</span>
<span class="sd">    &gt;&gt;&gt; sele_predicates, sele_APIs, API_URLs = sele_predicates_API(input_node1_category,input_node2_category,metaKG, APInames)</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">sele_predicates</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">select_concept</span><span class="p">(</span><span class="n">sub_list</span><span class="o">=</span><span class="n">input_node1_category</span><span class="p">,</span>
                                                 <span class="n">obj_list</span><span class="o">=</span><span class="n">input_node2_category</span><span class="p">,</span>
                                                 <span class="n">metaKG</span><span class="o">=</span><span class="n">metaKG</span><span class="p">)))</span>
    <span class="n">sele_APIs</span> <span class="o">=</span> <span class="n">select_API</span><span class="p">(</span><span class="n">sub_list</span><span class="o">=</span><span class="n">input_node1_category</span><span class="p">,</span>
                           <span class="n">obj_list</span><span class="o">=</span><span class="n">input_node2_category</span><span class="p">,</span>
                           <span class="n">metaKG</span><span class="o">=</span><span class="n">metaKG</span><span class="p">)</span>
    
    <span class="n">API_URLs</span> <span class="o">=</span> <span class="n">get_Translator_API_URL</span><span class="p">(</span><span class="n">sele_APIs</span><span class="p">,</span> <span class="n">APInames</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sele_predicates</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No predicates found for the given categories.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sele_APIs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No APIs found for the given categories.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">API_URLs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No API URLs found for the given categories.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sele_predicates</span><span class="p">,</span> <span class="n">sele_APIs</span><span class="p">,</span> <span class="n">API_URLs</span></div>

<span class="c1"># used. Dec 5, 2023 (Example_query_one_hop_with_category.ipynb)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_Translator_API_URL</span><span class="p">(</span><span class="n">API_sele</span><span class="p">,</span> <span class="n">APInames</span><span class="p">):</span>
    <span class="n">API_URL</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1">#API_URL = {}</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">API_sele</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">APInames</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">API_URL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">APInames</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
            <span class="c1">#API_URL[name] = APInames[name]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; : API name not found&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">API_URL</span>

<span class="c1"># select APIs based on the predicates. Dec 10, 2023</span>
<span class="k">def</span><span class="w"> </span><span class="nf">filter_APIs</span><span class="p">(</span><span class="n">sele_predicates</span><span class="p">,</span> <span class="n">metaKG</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">sele_predicates</span> <span class="o">==</span> <span class="p">[]:</span>
        <span class="n">sele_API_URL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;KG_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>    
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sele_API_URL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">metaKG</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;KG_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sele_predicates</span><span class="p">)][</span><span class="s1">&#39;URL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">sele_API_URL</span>

<div class="viewcode-block" id="select_predicates_inKP">
<a class="viewcode-back" href="../../TCT.html#TCT.TCT.select_predicates_inKP">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">select_predicates_inKP</span><span class="p">(</span><span class="n">sub_list</span><span class="p">,</span><span class="n">obj_list</span><span class="p">,</span><span class="n">KPname</span><span class="p">,</span><span class="n">metaKG</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;sub_list = [&quot;biolink:Gene&quot;, &quot;biolink:Protein&quot;]</span>
<span class="sd">      obj_list = [&quot;biolink:Gene&quot;, &quot;biolink:Disease&quot;]</span>
<span class="sd">      KPname = &quot;&quot; # it should be one of the names in APInames</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">new_sub_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">new_obj_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>
        <span class="n">new_sub_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj_list</span><span class="p">:</span>
        <span class="n">new_obj_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1">#result_df = pd.read_csv(&quot;KP_metadata.csv&quot;)</span>
    <span class="n">df1</span> <span class="o">=</span> <span class="n">metaKG</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">new_sub_list</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">new_obj_list</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;API&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">KPname</span><span class="p">)]</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">metaKG</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">new_obj_list</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">new_sub_list</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">metaKG</span><span class="p">[</span><span class="s1">&#39;API&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">KPname</span><span class="p">)]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">])</span>
    <span class="n">temp_set</span> <span class="o">=</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;KG_category&#39;</span><span class="p">])))</span>
    <span class="n">final_set</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">concept</span> <span class="ow">in</span> <span class="n">temp_set</span><span class="p">:</span>
        <span class="c1">#final_set.append(&quot;biolink:&quot;+concept.split(&quot;-&quot;)[1])</span>
        <span class="n">final_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">concept</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">final_set</span><span class="p">)</span></div>


    
<span class="c1">#def Generate_Gene_id_map():</span>
<span class="c1">#    id_file = open(&quot;../metaData/Homo_sapiens.gene_info&quot;, &quot;r&quot;)</span>
<span class="c1">#    Gene_id_map = {}</span>
<span class="c1">#    for line in id_file:</span>
<span class="c1">#        line = line.strip()</span>
<span class="c1">#        Gene_id_map[&quot;NCBIGene:&quot;+line.split(&quot;\t&quot;)[1]] = line.split(&quot;\t&quot;)[2]</span>
<span class="c1">#    id_file.close()</span>
<span class="c1">#    return(Gene_id_map)</span>

<span class="c1"># Used. Jan 5, 2024</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ID_convert_to_preferred_name_nodeNormalizer</span><span class="p">(</span><span class="n">id_list</span><span class="p">):</span>
    <span class="n">dic_id_map</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">unrecoglized_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">recoglized_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># To convert a CURIE to a preferred name, you don&#39;t need NameLookup at all -- NodeNorm can</span>
    <span class="c1"># do this by itself!</span>
    <span class="n">NODENORM_BASE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://nodenorm.transltr.io&quot;</span>  <span class="c1"># Adjust this if you need NodeNorm TEST, CI or DEV.</span>
    <span class="n">NODENORM_BATCH_LIMIT</span> <span class="o">=</span> <span class="mi">900</span>                          <span class="c1"># Adjust this if you start getting errors from NodeNorm.</span>
    <span class="n">NODENORM_GENE_PROTEIN_CONFLATION</span> <span class="o">=</span> <span class="kc">True</span>             <span class="c1"># Change to False if you don&#39;t want gene/protein conflation.</span>
    <span class="n">NODENORM_DRUG_CHEMICAL_CONFLATION</span> <span class="o">=</span> <span class="kc">False</span>           <span class="c1"># Change to True if you want drug/chemical conflation.</span>

    <span class="c1"># split id_list into batches of at most NODENORM_BATCH_LIMIT entries</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">id_list</span><span class="p">),</span> <span class="n">NODENORM_BATCH_LIMIT</span><span class="p">):</span>
        <span class="n">id_sublist</span> <span class="o">=</span> <span class="n">id_list</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span> <span class="o">+</span> <span class="n">NODENORM_BATCH_LIMIT</span><span class="p">]</span>

        <span class="c1"># print(f&quot;id_sublist: {id_sublist}&quot;)</span>

        <span class="c1"># Query NodeNorm with https://nodenorm.transltr.io/docs#/default/get_normalized_node_handler_get_normalized_nodes_get</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">NODENORM_BASE_URL</span> <span class="o">+</span> <span class="s1">&#39;/get_normalized_nodes&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;curies&quot;</span><span class="p">:</span> <span class="n">id_sublist</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>   <span class="c1"># Change to True if you want descriptions from any identifiers we know about.</span>
            <span class="s2">&quot;conflate&quot;</span><span class="p">:</span> <span class="n">NODENORM_GENE_PROTEIN_CONFLATION</span><span class="p">,</span>
            <span class="s2">&quot;drug_chemical_conflate&quot;</span><span class="p">:</span> <span class="n">NODENORM_DRUG_CHEMICAL_CONFLATION</span><span class="p">,</span>
        <span class="p">})</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Error: NodeNorm request failed with status code &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">))</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">curie</span> <span class="ow">in</span> <span class="n">id_sublist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">curie</span> <span class="ow">in</span> <span class="n">results</span> <span class="ow">and</span> <span class="n">results</span><span class="p">[</span><span class="n">curie</span><span class="p">]:</span>
                <span class="n">identifier</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">curie</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="p">{})</span>
                <span class="k">if</span> <span class="s1">&#39;identifier&#39;</span> <span class="ow">in</span> <span class="n">identifier</span> <span class="ow">and</span> <span class="n">identifier</span><span class="p">[</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">curie</span><span class="p">:</span>
                    <span class="n">recoglized_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curie</span><span class="p">)</span>
                    <span class="c1">#print(f&quot;NodeNorm normalized {curie} to {identifier[&#39;identifier&#39;]} &quot; +</span>
                    <span class="c1">#      f&quot;with gene-protein conflation {NODENORM_GENE_PROTEIN_CONFLATION} and &quot; +</span>
                    <span class="c1">#      f&quot;with drug-chemical conflation {NODENORM_DRUG_CHEMICAL_CONFLATION}.&quot;)</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">identifier</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
                <span class="n">dic_id_map</span><span class="p">[</span><span class="n">curie</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">label</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">curie</span> <span class="o">+</span> <span class="s2">&quot;: no preferred name&quot;</span><span class="p">)</span>
                    <span class="n">dic_id_map</span><span class="p">[</span><span class="n">curie</span><span class="p">]</span> <span class="o">=</span> <span class="n">curie</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unrecoglized_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curie</span><span class="p">)</span>
                
                <span class="n">dic_id_map</span><span class="p">[</span><span class="n">curie</span><span class="p">]</span> <span class="o">=</span> <span class="n">curie</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unrecoglized_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NodeNorm does not know about these identifiers: &quot;</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unrecoglized_ids</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">dic_id_map</span>


<span class="k">def</span><span class="w"> </span><span class="nf">visulization_one_hop_ranking_input_as_list</span><span class="p">(</span><span class="n">result_ranked_by_primary_infores</span><span class="p">,</span><span class="n">result_parsed</span> <span class="p">,</span> 
                                 <span class="n">num_of_nodes</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> 
                                 <span class="n">input_query</span> <span class="o">=</span> <span class="s2">&quot;NCBIGene:3845&quot;</span><span class="p">,</span>
                                 <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
                                 <span class="n">title_fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
                                 <span class="n">output_png1</span><span class="o">=</span><span class="s2">&quot;NE_heatmap1.png&quot;</span><span class="p">,</span>
                                 <span class="n">output_png2</span><span class="o">=</span><span class="s2">&quot;NE_heatmap2.png&quot;</span>
                                 <span class="p">):</span>
    <span class="c1"># edited Dec 5, 2023</span>
    <span class="n">predicates_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">primary_infore_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">aggregator_infore_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">BytesIO</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">result_ranked_by_primary_infores</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">oupput_node</span> <span class="o">=</span> <span class="n">result_ranked_by_primary_infores</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="n">type_of_node</span> <span class="o">=</span> <span class="n">result_ranked_by_primary_infores</span><span class="p">[</span><span class="s1">&#39;type_of_nodes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">type_of_node</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span>
            <span class="n">subject</span> <span class="o">=</span> <span class="n">input_query</span>
            <span class="nb">object</span> <span class="o">=</span> <span class="n">oupput_node</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subject</span> <span class="o">=</span> <span class="n">oupput_node</span>
            <span class="nb">object</span> <span class="o">=</span> <span class="n">input_query</span>
            
        <span class="n">predicates_list</span> <span class="o">=</span> <span class="n">predicates_list</span> <span class="o">+</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">object</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">]</span>
        <span class="n">primary_infore_list</span> <span class="o">=</span> <span class="n">primary_infore_list</span> <span class="o">+</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">object</span><span class="p">][</span><span class="s1">&#39;primary_knowledge_source&#39;</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="s1">&#39;aggregator_knowledge_source&#39;</span> <span class="ow">in</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">object</span><span class="p">]:</span>
            <span class="n">aggregator_infore_list</span> <span class="o">=</span> <span class="n">aggregator_infore_list</span> <span class="o">+</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">object</span><span class="p">][</span><span class="s1">&#39;aggregator_knowledge_source&#39;</span><span class="p">]</span>
            <span class="n">aggregator_infore_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">aggregator_infore_list</span><span class="p">))</span>

        <span class="n">predicates_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">predicates_list</span><span class="p">))</span>
        <span class="n">primary_infore_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">primary_infore_list</span><span class="p">))</span>
        

    <span class="n">predicates_by_nodes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">predict</span> <span class="ow">in</span> <span class="n">predicates_list</span><span class="p">:</span>
        <span class="n">predicates_by_nodes</span><span class="p">[</span><span class="n">predict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">primary_infore_by_nodes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">predict</span> <span class="ow">in</span> <span class="n">primary_infore_list</span><span class="p">:</span>
        <span class="n">primary_infore_by_nodes</span><span class="p">[</span><span class="n">predict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">aggregator_infore_by_nodes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">predict</span> <span class="ow">in</span> <span class="n">aggregator_infore_list</span><span class="p">:</span>
        <span class="n">aggregator_infore_by_nodes</span><span class="p">[</span><span class="n">predict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">result_ranked_by_primary_infores</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="c1">#for i in range(0, 10):</span>
        <span class="n">input_nodes</span> <span class="o">=</span> <span class="n">result_ranked_by_primary_infores</span><span class="p">[</span><span class="s1">&#39;input_node&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">oupput_node</span> <span class="o">=</span> <span class="n">result_ranked_by_primary_infores</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oupput_node</span><span class="p">)</span>
        <span class="n">type_of_node</span> <span class="o">=</span> <span class="n">result_ranked_by_primary_infores</span><span class="p">[</span><span class="s1">&#39;type_of_nodes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">type_of_node</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span>
            <span class="n">subject</span> <span class="o">=</span> <span class="n">input_query</span>
            <span class="nb">object</span> <span class="o">=</span> <span class="n">oupput_node</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subject</span> <span class="o">=</span> <span class="n">oupput_node</span>
            <span class="nb">object</span> <span class="o">=</span> <span class="n">input_query</span>
        <span class="n">new_id</span> <span class="o">=</span> <span class="n">subject</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">object</span>

        <span class="n">cur_primary_infore</span> <span class="o">=</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">new_id</span><span class="p">][</span><span class="s1">&#39;primary_knowledge_source&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">predict</span> <span class="ow">in</span> <span class="n">primary_infore_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">predict</span> <span class="ow">in</span> <span class="n">cur_primary_infore</span><span class="p">:</span>
                <span class="n">primary_infore_by_nodes</span><span class="p">[</span><span class="n">predict</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">primary_infore_by_nodes</span><span class="p">[</span><span class="n">predict</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>



        <span class="n">cur_predicates</span> <span class="o">=</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">new_id</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">predict</span> <span class="ow">in</span> <span class="n">predicates_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">predict</span> <span class="ow">in</span> <span class="n">cur_predicates</span><span class="p">:</span>
                <span class="n">predicates_by_nodes</span><span class="p">[</span><span class="n">predict</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">predicates_by_nodes</span><span class="p">[</span><span class="n">predict</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1">#convert = False</span>

    <span class="c1">#for item in colnames:</span>
    <span class="c1">#    if &#39;NCBIGene&#39; in item:</span>
    <span class="c1">#        convert = True</span>
    <span class="c1">#if convert:</span>
        <span class="c1">#Gene_id_map = Gene_id_converter(colnames, &quot;http://127.0.0.1:8000/query_name_by_id&quot;) # option 1</span>
        <span class="c1">#Gene_id_map = Generate_Gene_id_map() # option 2</span>

    <span class="n">dic_id_map</span> <span class="o">=</span> <span class="n">ID_convert_to_preferred_name_nodeNormalizer</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dic_id_map</span><span class="p">:</span>
            <span class="n">new_colnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic_id_map</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_colnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>    

    <span class="c1">#else:</span>
    <span class="c1">#    new_colnames = colnames</span>
            
    <span class="n">primary_infore_by_nodes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">primary_infore_by_nodes</span><span class="p">)</span>
    <span class="n">primary_infore_by_nodes_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">new_colnames</span>
    <span class="n">primary_infore_by_nodes_df</span> <span class="o">=</span> <span class="n">primary_infore_by_nodes_df</span><span class="o">.</span><span class="n">T</span>


    <span class="n">predicates_by_nodes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">predicates_by_nodes</span><span class="p">)</span>
    <span class="n">predicates_by_nodes_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">new_colnames</span>
    <span class="n">predicates_by_nodes_df</span> <span class="o">=</span> <span class="n">predicates_by_nodes_df</span><span class="o">.</span><span class="n">T</span>

    <span class="n">plot_heatmap</span><span class="p">(</span><span class="n">primary_infore_by_nodes_df</span><span class="p">,</span> <span class="n">num_of_nodes</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span> <span class="n">title_fontsize</span><span class="p">,</span><span class="n">output_png1</span><span class="p">)</span>
    <span class="n">plot_heatmap</span><span class="p">(</span><span class="n">predicates_by_nodes_df</span><span class="p">,</span> <span class="n">num_of_nodes</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span> <span class="n">title_fontsize</span><span class="p">,</span><span class="n">output_png2</span><span class="p">)</span>

    <span class="k">return</span><span class="p">(</span><span class="n">predicates_by_nodes_df</span><span class="p">)</span>

<span class="c1"># Used. Jan 5, 2024</span>
<span class="k">def</span><span class="w"> </span><span class="nf">visulization_one_hop_ranking</span><span class="p">(</span><span class="n">result_ranked_by_primary_infores</span><span class="p">,</span><span class="n">result_parsed</span> <span class="p">,</span> 
                                 <span class="n">num_of_nodes</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> 
                                 <span class="n">input_query</span> <span class="o">=</span> <span class="s2">&quot;NCBIGene:3845&quot;</span><span class="p">,</span>
                                 <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
                                 <span class="n">title_fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
                                 <span class="n">output_png1</span><span class="o">=</span><span class="s2">&quot;NE_heatmap1.png&quot;</span><span class="p">,</span>
                                 <span class="n">output_png2</span><span class="o">=</span><span class="s2">&quot;NE_heatmap2.png&quot;</span>
                                 <span class="p">):</span>
    <span class="c1"># edited Dec 5, 2023</span>
    <span class="n">predicates_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">primary_infore_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">aggregator_infore_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">BytesIO</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">result_ranked_by_primary_infores</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">oupput_node</span> <span class="o">=</span> <span class="n">result_ranked_by_primary_infores</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="n">type_of_node</span> <span class="o">=</span> <span class="n">result_ranked_by_primary_infores</span><span class="p">[</span><span class="s1">&#39;type_of_nodes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">type_of_node</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span>
            <span class="n">subject</span> <span class="o">=</span> <span class="n">input_query</span>
            <span class="nb">object</span> <span class="o">=</span> <span class="n">oupput_node</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subject</span> <span class="o">=</span> <span class="n">oupput_node</span>
            <span class="nb">object</span> <span class="o">=</span> <span class="n">input_query</span>
            
        <span class="n">predicates_list</span> <span class="o">=</span> <span class="n">predicates_list</span> <span class="o">+</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">object</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">]</span>
        <span class="n">primary_infore_list</span> <span class="o">=</span> <span class="n">primary_infore_list</span> <span class="o">+</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">object</span><span class="p">][</span><span class="s1">&#39;primary_knowledge_source&#39;</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="s1">&#39;aggregator_knowledge_source&#39;</span> <span class="ow">in</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">object</span><span class="p">]:</span>
            <span class="n">aggregator_infore_list</span> <span class="o">=</span> <span class="n">aggregator_infore_list</span> <span class="o">+</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">object</span><span class="p">][</span><span class="s1">&#39;aggregator_knowledge_source&#39;</span><span class="p">]</span>
            <span class="n">aggregator_infore_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">aggregator_infore_list</span><span class="p">))</span>

        <span class="n">predicates_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">predicates_list</span><span class="p">))</span>
        <span class="n">primary_infore_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">primary_infore_list</span><span class="p">))</span>
        

    <span class="n">predicates_by_nodes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">predict</span> <span class="ow">in</span> <span class="n">predicates_list</span><span class="p">:</span>
        <span class="n">predicates_by_nodes</span><span class="p">[</span><span class="n">predict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">primary_infore_by_nodes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">predict</span> <span class="ow">in</span> <span class="n">primary_infore_list</span><span class="p">:</span>
        <span class="n">primary_infore_by_nodes</span><span class="p">[</span><span class="n">predict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">aggregator_infore_by_nodes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">predict</span> <span class="ow">in</span> <span class="n">aggregator_infore_list</span><span class="p">:</span>
        <span class="n">aggregator_infore_by_nodes</span><span class="p">[</span><span class="n">predict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">result_ranked_by_primary_infores</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="c1">#for i in range(0, 10):</span>
        <span class="n">oupput_node</span> <span class="o">=</span> <span class="n">result_ranked_by_primary_infores</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oupput_node</span><span class="p">)</span>
        <span class="n">type_of_node</span> <span class="o">=</span> <span class="n">result_ranked_by_primary_infores</span><span class="p">[</span><span class="s1">&#39;type_of_nodes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">type_of_node</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span>
            <span class="n">subject</span> <span class="o">=</span> <span class="n">input_query</span>
            <span class="nb">object</span> <span class="o">=</span> <span class="n">oupput_node</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subject</span> <span class="o">=</span> <span class="n">oupput_node</span>
            <span class="nb">object</span> <span class="o">=</span> <span class="n">input_query</span>
        <span class="n">new_id</span> <span class="o">=</span> <span class="n">subject</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">object</span>

        <span class="n">cur_primary_infore</span> <span class="o">=</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">new_id</span><span class="p">][</span><span class="s1">&#39;primary_knowledge_source&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">predict</span> <span class="ow">in</span> <span class="n">primary_infore_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">predict</span> <span class="ow">in</span> <span class="n">cur_primary_infore</span><span class="p">:</span>
                <span class="n">primary_infore_by_nodes</span><span class="p">[</span><span class="n">predict</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">primary_infore_by_nodes</span><span class="p">[</span><span class="n">predict</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>



        <span class="n">cur_predicates</span> <span class="o">=</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">new_id</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">predict</span> <span class="ow">in</span> <span class="n">predicates_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">predict</span> <span class="ow">in</span> <span class="n">cur_predicates</span><span class="p">:</span>
                <span class="n">predicates_by_nodes</span><span class="p">[</span><span class="n">predict</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">predicates_by_nodes</span><span class="p">[</span><span class="n">predict</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1">#convert = False</span>

    <span class="c1">#for item in colnames:</span>
    <span class="c1">#    if &#39;NCBIGene&#39; in item:</span>
    <span class="c1">#        convert = True</span>
    <span class="c1">#if convert:</span>
        <span class="c1">#Gene_id_map = Gene_id_converter(colnames, &quot;http://127.0.0.1:8000/query_name_by_id&quot;) # option 1</span>
        <span class="c1">#Gene_id_map = Generate_Gene_id_map() # option 2</span>

    <span class="n">dic_id_map</span> <span class="o">=</span> <span class="n">ID_convert_to_preferred_name_nodeNormalizer</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dic_id_map</span><span class="p">:</span>
            <span class="n">new_colnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic_id_map</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_colnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>    

    <span class="c1">#else:</span>
    <span class="c1">#    new_colnames = colnames</span>
            
    <span class="n">primary_infore_by_nodes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">primary_infore_by_nodes</span><span class="p">)</span>
    <span class="n">primary_infore_by_nodes_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">new_colnames</span>
    <span class="n">primary_infore_by_nodes_df</span> <span class="o">=</span> <span class="n">primary_infore_by_nodes_df</span><span class="o">.</span><span class="n">T</span>


    <span class="n">predicates_by_nodes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">predicates_by_nodes</span><span class="p">)</span>
    <span class="n">predicates_by_nodes_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">new_colnames</span>
    <span class="n">predicates_by_nodes_df</span> <span class="o">=</span> <span class="n">predicates_by_nodes_df</span><span class="o">.</span><span class="n">T</span>

    <span class="n">plot_heatmap</span><span class="p">(</span><span class="n">primary_infore_by_nodes_df</span><span class="p">,</span> <span class="n">num_of_nodes</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span> <span class="n">title_fontsize</span><span class="p">,</span><span class="n">output_png1</span><span class="p">)</span>
    <span class="n">plot_heatmap</span><span class="p">(</span><span class="n">predicates_by_nodes_df</span><span class="p">,</span> <span class="n">num_of_nodes</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span> <span class="n">title_fontsize</span><span class="p">,</span><span class="n">output_png2</span><span class="p">)</span>

    <span class="k">return</span><span class="p">(</span><span class="n">predicates_by_nodes_df</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_heatmap</span><span class="p">(</span><span class="n">predicates_by_nodes_df</span><span class="p">,</span><span class="n">num_of_nodes</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> 
                                 <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
                                 <span class="n">title_fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                                 <span class="n">output_png</span><span class="o">=</span><span class="s2">&quot;NE_heatmap.png&quot;</span><span class="p">):</span>
    <span class="c1">#matplotlib.use(&#39;Agg&#39;)</span>
    
    <span class="c1">#title = &quot;Ranking of one-hop nodes by primary infores&quot;</span>
    <span class="c1">#ylab = &quot;infores&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">predicates_by_nodes_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">num_of_nodes</span><span class="p">]</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="c1"># create teh figure and subplot</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="o">+</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">0.11</span><span class="p">,</span><span class="mf">3.5</span><span class="p">),</span><span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

    <span class="c1"># create the heatmap</span>
    <span class="c1"># heatmap with border</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="c1"># Adjust font size for x and y tick labels</span>
    <span class="n">p1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="n">p1</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

    <span class="c1">#p1.set_title(title)</span>
    <span class="c1">#p1.set_ylabel(ylab)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">())</span>
    <span class="c1"># set xticklabels with colnames</span>

    <span class="c1">#p1.set_xticklabels(colnames, rotation=90, fontsize = fontsize)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="c1"># set title font size</span>
    <span class="n">p1</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">title_fontsize</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="c1"># save the figure</span>
    <span class="c1">#plt.savefig(output_png, bbox_inches=&#39;tight&#39;, dpi=300)</span>



<span class="k">def</span><span class="w"> </span><span class="nf">plot_heatmap_ui</span><span class="p">(</span><span class="n">predicates_by_nodes_df</span><span class="p">,</span><span class="n">num_of_nodes</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> 
                                 <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
                                 <span class="n">title_fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                                 <span class="n">output_png</span><span class="o">=</span><span class="s2">&quot;NE_heatmap.png&quot;</span><span class="p">):</span>
   
    
    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Ranking of one-hop nodes by primary infores&quot;</span>
    <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;infores&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">predicates_by_nodes_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">num_of_nodes</span><span class="p">]</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="c1"># create teh figure and subplot</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="o">+</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">3.5</span><span class="p">),</span><span class="n">dpi</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

    <span class="c1"># create the heatmap</span>
    <span class="c1"># heatmap with border</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

    <span class="n">p1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">p1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylab</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">())</span>
    <span class="c1"># set xticklabels with colnames</span>

    <span class="c1">#p1.set_xticklabels(colnames, rotation=90, fontsize = fontsize)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="c1"># set title font size</span>
    <span class="n">p1</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">title_fontsize</span><span class="p">)</span>
   <span class="c1"># plt.show()</span>
    <span class="c1"># save the figure</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_png</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>


<span class="c1"># used. Dec 5, 2023  (Example_query_one_hop_with_category.ipynb)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">Gene_id_converter</span><span class="p">(</span><span class="n">id_list</span><span class="p">,</span> <span class="n">API_url</span><span class="p">):</span>
    <span class="n">id_list_new</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">id_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;NCBIGene:&quot;</span><span class="p">):</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="nb">id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;NCBIGene:&quot;</span><span class="p">,</span> <span class="s2">&quot;NCBIGene&quot;</span><span class="p">)</span>
            <span class="n">id_list_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">query_json</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;query_graph&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;n0&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;categories&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Gene&quot;</span><span class="p">],</span>
                            <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="n">id_list_new</span>
                            <span class="p">},</span>
                            <span class="s2">&quot;n1&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;categories&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;string&quot;</span>
                            <span class="p">],</span>
                            <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;string&quot;</span>
                            <span class="p">]</span>
                            <span class="p">}</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;e1&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;predicates&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;string&quot;</span>
                            <span class="p">]</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="p">}</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">API_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">query_json</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

    <span class="k">return</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>


<span class="c1"># used. Dec 5, 2023 (Example_query_one_hop_with_category.ipynb)</span>
<div class="viewcode-block" id="format_query_json">
<a class="viewcode-back" href="../../TCT.html#TCT.TCT.format_query_json">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">format_query_json</span><span class="p">(</span><span class="n">subject_ids</span><span class="p">,</span> <span class="n">object_ids</span><span class="p">,</span> <span class="n">subject_categories</span><span class="p">,</span> <span class="n">object_categories</span><span class="p">,</span> <span class="n">predicates</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Example input:</span>
<span class="sd">    subject_ids = [&quot;NCBIGene:3845&quot;]</span>
<span class="sd">    object_ids = []</span>
<span class="sd">    subject_categories = [&quot;biolink:Gene&quot;]</span>
<span class="sd">    object_categories = [&quot;biolink:Gene&quot;]</span>
<span class="sd">    predicates = [&quot;biolink:positively_correlated_with&quot;, &quot;biolink:physically_interacts_with&quot;]</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">#edited Dec 5, 2023</span>
    <span class="n">query_json_temp</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;query_graph&quot;</span><span class="p">:</span> <span class="p">{</span>
                
                <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;e00&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="c1">#&quot;e1&quot;: {</span>
                        <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;n01&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;object&quot;</span><span class="p">:</span> <span class="s2">&quot;n00&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;predicates&quot;</span><span class="p">:</span> <span class="n">predicates</span>
                        <span class="p">}</span>
                    <span class="p">},</span>
                <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;n00&quot;</span><span class="p">:</span> <span class="p">{</span>    
                        <span class="s2">&quot;ids&quot;</span><span class="p">:</span><span class="n">subject_ids</span><span class="p">,</span> <span class="c1"># required</span>
                        <span class="c1">#&quot;categories&quot;:[] # optional, if not provided, it will be empty</span>
                        <span class="p">},</span>
                    <span class="s2">&quot;n01&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="c1">#&quot;ids&quot;:[],</span>
                        <span class="s2">&quot;categories&quot;</span><span class="p">:[]</span> <span class="c1"># required</span>
                        <span class="p">}}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">subject_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#query_json_temp[&quot;message&quot;][&quot;query_graph&quot;][&quot;nodes&quot;][&quot;n0&quot;][&quot;ids&quot;] = subject_ids</span>
        <span class="n">query_json_temp</span><span class="p">[</span><span class="s2">&quot;message&quot;</span><span class="p">][</span><span class="s2">&quot;query_graph&quot;</span><span class="p">][</span><span class="s2">&quot;nodes&quot;</span><span class="p">][</span><span class="s2">&quot;n00&quot;</span><span class="p">][</span><span class="s2">&quot;ids&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject_ids</span>

    <span class="c1">#if len(object_ids) &gt; 0:</span>
        <span class="c1">#query_json_temp[&quot;message&quot;][&quot;query_graph&quot;][&quot;nodes&quot;][&quot;n1&quot;][&quot;ids&quot;] = object_ids</span>
        <span class="c1">#query_json_temp[&quot;message&quot;][&quot;query_graph&quot;][&quot;nodes&quot;][&quot;n00&quot;][&quot;ids&quot;] = object_ids</span>

    <span class="c1">#if len(subject_categories) &gt; 0:</span>
    <span class="c1">#    query_json_temp[&quot;message&quot;][&quot;query_graph&quot;][&quot;nodes&quot;][&quot;n01&quot;][&quot;categories&quot;] = subject_categories</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_categories</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#query_json_temp[&quot;message&quot;][&quot;query_graph&quot;][&quot;nodes&quot;][&quot;n1&quot;][&quot;categories&quot;] = object_categories</span>
        <span class="n">query_json_temp</span><span class="p">[</span><span class="s2">&quot;message&quot;</span><span class="p">][</span><span class="s2">&quot;query_graph&quot;</span><span class="p">][</span><span class="s2">&quot;nodes&quot;</span><span class="p">][</span><span class="s2">&quot;n01&quot;</span><span class="p">][</span><span class="s2">&quot;categories&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">object_categories</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">predicates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">query_json_temp</span><span class="p">[</span><span class="s2">&quot;message&quot;</span><span class="p">][</span><span class="s2">&quot;query_graph&quot;</span><span class="p">][</span><span class="s2">&quot;edges&quot;</span><span class="p">][</span><span class="s2">&quot;e00&quot;</span><span class="p">][</span><span class="s2">&quot;predicates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predicates</span>

    <span class="k">return</span><span class="p">(</span><span class="n">query_json_temp</span><span class="p">)</span></div>



<div class="viewcode-block" id="Neiborhood_finder">
<a class="viewcode-back" href="../../TCT.html#TCT.TCT.Neiborhood_finder">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">Neiborhood_finder</span><span class="p">(</span><span class="n">input_node</span><span class="p">,</span> <span class="n">node2_categories</span><span class="p">,</span> <span class="n">APInames</span><span class="p">,</span> <span class="n">metaKG</span><span class="p">,</span> <span class="n">API_predicates</span><span class="p">,</span> <span class="n">input_node_category</span> <span class="o">=</span> <span class="p">[]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is used to find the neighborhood of a given input node with intermediate categories.</span>
<span class="sd">    </span>
<span class="sd">    --------------</span>
<span class="sd">    Parameters:</span>
<span class="sd">    input_node (str): The input node, can be a gene name, protein name, or any other identifier.</span>
<span class="sd">    node2_categories (list): A list of intermediate categories to be used in the neighborhood finding process.</span>
<span class="sd">    APInames (dict): A dictionary containing the names of the APIs to be used.</span>
<span class="sd">    metaKG (DataFrame): The metadata knowledge graph containing information about the APIs and their predicates.</span>
<span class="sd">    API_predicates (dict): A dictionary containing the predicates for each API.</span>
<span class="sd">    input_node_category (list): Optional. A list of categories for the input node. If empty, it will be derived from the input node&#39;s types.</span>
<span class="sd">    </span>
<span class="sd">    --------------</span>
<span class="sd">    Returns:</span>
<span class="sd">    input_node_id (str): The curie id of the input node.</span>
<span class="sd">    result (dict): The result of the query for the input node.</span>
<span class="sd">    result_parsed (DataFrame): The parsed results for the input node.</span>
<span class="sd">    result_ranked_by_primary_infores (DataFrame): The ranked results based on primary infores.</span>
<span class="sd">    </span>
<span class="sd">    --------------</span>
<span class="sd">    Example:</span>
<span class="sd">    &gt;&gt;&gt; input_node_id, result, result_parsed, result_ranked_by_primary_infores1 = Neiborhood_finder(&#39;Ovarian cancer&#39;,</span>
<span class="sd">                                                                                            node2_categories = [&#39;biolink:SmallMolecule&#39;, &#39;biolink:Drug&#39;, &#39;biolink:ChemicalEntity&#39;],</span>
<span class="sd">                                                                                            APInames = APInames,</span>
<span class="sd">                                                                                            metaKG = metaKG,</span>
<span class="sd">                                                                                            API_predicates = API_predicates)   </span>
<span class="sd">    --------------</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">TCT</span><span class="w"> </span><span class="kn">import</span> <span class="n">name_resolver</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">TCT</span><span class="w"> </span><span class="kn">import</span> <span class="n">translator_metakg</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">TCT</span><span class="w"> </span><span class="kn">import</span> <span class="n">translator_kpinfo</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">TCT</span><span class="w"> </span><span class="kn">import</span> <span class="n">translator_query</span>

    <span class="c1"># Step 1: Resolve the input node to get its curie id and categories</span>
    <span class="n">input_node_info</span> <span class="o">=</span> <span class="n">name_resolver</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">input_node</span><span class="p">)</span>
    <span class="n">input_node_id</span> <span class="o">=</span> <span class="n">input_node_info</span><span class="o">.</span><span class="n">curie</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">input_node_id</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_node_category</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">input_node_category</span> <span class="o">=</span> <span class="n">input_node_info</span><span class="o">.</span><span class="n">types</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">input_node_category</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">input_node_category</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">input_node_info</span><span class="o">.</span><span class="n">types</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_node_category</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">input_node_category</span> <span class="o">=</span> <span class="n">input_node_info</span><span class="o">.</span><span class="n">types</span>

    <span class="c1"># Step 2: Select predicates and APIs based on the intermediate categories</span>
    <span class="n">sele_predicates</span><span class="p">,</span> <span class="n">sele_APIs</span><span class="p">,</span> <span class="n">API_URLs</span> <span class="o">=</span> <span class="n">sele_predicates_API</span><span class="p">(</span><span class="n">input_node_category</span><span class="p">,</span>
                                                                <span class="n">node2_categories</span><span class="p">,</span>
                                                                <span class="n">metaKG</span><span class="p">,</span> <span class="n">APInames</span><span class="p">)</span>

    <span class="c1"># Step 3: Format the query JSON for the input node</span>
    <span class="n">query_json</span> <span class="o">=</span> <span class="n">format_query_json</span><span class="p">([</span><span class="n">input_node_id</span><span class="p">],</span> <span class="p">[],</span> 
                                   <span class="p">[</span><span class="n">input_node_category</span><span class="p">],</span> 
                                   <span class="n">node2_categories</span><span class="p">,</span> 
                                   <span class="n">sele_predicates</span><span class="p">)</span>

    <span class="c1"># Step 4: Query the APIs in parallel</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">translator_query</span><span class="o">.</span><span class="n">parallel_api_query</span><span class="p">(</span><span class="n">query_json</span><span class="o">=</span><span class="n">query_json</span><span class="p">,</span> 
                             <span class="n">select_APIs</span><span class="o">=</span> <span class="n">sele_APIs</span><span class="p">,</span> 
                             <span class="n">APInames</span><span class="o">=</span><span class="n">APInames</span><span class="p">,</span>
                             <span class="n">API_predicates</span><span class="o">=</span><span class="n">API_predicates</span><span class="p">,</span>
                             <span class="n">max_workers</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sele_APIs</span><span class="p">))</span>
    <span class="n">result_parsed</span> <span class="o">=</span> <span class="n">parse_KG</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="c1"># Step 7: Ranking the results. This ranking method is based on the number of unique</span>
        <span class="c1"># primary infores. It can only be used to rank the results with one defined node.</span>
    <span class="n">result_ranked_by_primary_infores1</span> <span class="o">=</span> <span class="n">rank_by_primary_infores</span><span class="p">(</span><span class="n">result_parsed</span><span class="p">,</span> <span class="n">input_node_id</span><span class="p">)</span>   <span class="c1"># input_node1_id is the curie id of the</span>
    <span class="k">return</span> <span class="n">input_node_id</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">result_parsed</span><span class="p">,</span> <span class="n">result_ranked_by_primary_infores1</span></div>


<div class="viewcode-block" id="Path_finder">
<a class="viewcode-back" href="../../TCT.html#TCT.TCT.Path_finder">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">Path_finder</span><span class="p">(</span><span class="n">input_node1</span><span class="p">,</span> <span class="n">input_node2</span><span class="p">,</span> <span class="n">intermediate_categories</span><span class="p">,</span> <span class="n">APInames</span><span class="p">,</span> <span class="n">metaKG</span><span class="p">,</span> <span class="n">API_predicates</span><span class="p">,</span> <span class="n">input_node1_category</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">input_node2_category</span> <span class="o">=</span> <span class="p">[]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is used to find paths between two input nodes with intermediate categories.</span>
<span class="sd">    </span>
<span class="sd">    --------------</span>
<span class="sd">    Parameters:</span>
<span class="sd">    input_node1 (str): The first input node, can be a gene name, protein name, or any other identifier.</span>
<span class="sd">    input_node2 (str): The second input node, can be a gene name, protein name, or any other identifier.</span>
<span class="sd">    intermediate_categories (list): A list of intermediate categories to be used in the path finding process.</span>
<span class="sd">    </span>
<span class="sd">    --------------</span>
<span class="sd">    Returns:</span>
<span class="sd">    paths (DataFrame): A DataFrame containing the paths found between the two input nodes.</span>
<span class="sd">    input_node1_id (str): The curie id of the first input node.</span>
<span class="sd">    input_node2_id (str): The curie id of the second input node.</span>
<span class="sd">    result1 (dict): The result of the query for the first input node.</span>
<span class="sd">    result2 (dict): The result of the query for the second input node.</span>
<span class="sd">    result_parsed1 (DataFrame): The parsed results for the first input node.</span>
<span class="sd">    result_parsed2 (DataFrame): The parsed results for the second input node.</span>
<span class="sd">    result_ranked_by_primary_infores1 (DataFrame): The ranked results for the first input node based on primary infores.</span>
<span class="sd">    result_ranked_by_primary_infores2 (DataFrame): The ranked results for the second</span>
<span class="sd">    --------------</span>
<span class="sd">    Example:</span>
<span class="sd">    &gt;&gt;&gt; paths, input_node1_id, input_node2_id, result1, result2, result_parsed1, result_parsed2, result_ranked_by_primary_infores1, result_ranked_by_primary_infores2 = Path_finder(&#39;WNT7B&#39;, &#39;NPM1&#39;, [&#39;biolink:Gene&#39;, &#39;biolink:Protein&#39;])</span>
<span class="sd">    --------------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">TCT</span><span class="w"> </span><span class="kn">import</span> <span class="n">name_resolver</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">TCT</span><span class="w"> </span><span class="kn">import</span> <span class="n">translator_metakg</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">TCT</span><span class="w"> </span><span class="kn">import</span> <span class="n">translator_kpinfo</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">TCT</span><span class="w"> </span><span class="kn">import</span> <span class="n">translator_query</span>
    <span class="n">input_node1_info</span> <span class="o">=</span> <span class="n">name_resolver</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">input_node1</span><span class="p">)</span>
    <span class="n">input_node1_id</span> <span class="o">=</span> <span class="n">input_node1_info</span><span class="o">.</span><span class="n">curie</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">input_node1_id</span><span class="p">)</span>
    <span class="n">input_node1_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">input_node1_id</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_node1_category</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">input_node1_category</span> <span class="o">=</span> <span class="n">input_node1_info</span><span class="o">.</span><span class="n">types</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">input_node1_category</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">input_node1_category</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">input_node1_info</span><span class="o">.</span><span class="n">types</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_node1_category</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">input_node1_category</span> <span class="o">=</span> <span class="n">input_node1_info</span><span class="o">.</span><span class="n">types</span>

    <span class="n">input_node2_info</span> <span class="o">=</span> <span class="n">name_resolver</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">input_node2</span><span class="p">)</span>
    <span class="n">input_node2_id</span> <span class="o">=</span> <span class="n">input_node2_info</span><span class="o">.</span><span class="n">curie</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">input_node2_id</span><span class="p">)</span>
    <span class="n">input_node2_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">input_node2_id</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_node2_category</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">input_node2_category</span> <span class="o">=</span> <span class="n">input_node2_info</span><span class="o">.</span><span class="n">types</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">input_node2_category</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">input_node2_category</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">input_node2_info</span><span class="o">.</span><span class="n">types</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_node2_category</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">input_node2_category</span> <span class="o">=</span> <span class="n">input_node2_info</span><span class="o">.</span><span class="n">types</span>


    <span class="c1"># Step 5: Select predicates and APIs based on the intermediate categories</span>
    <span class="n">sele_predicates1</span><span class="p">,</span> <span class="n">sele_APIs1</span><span class="p">,</span> <span class="n">API_URLs1</span> <span class="o">=</span> <span class="n">sele_predicates_API</span><span class="p">(</span><span class="n">input_node1_category</span><span class="p">,</span>
                                                                <span class="n">intermediate_categories</span><span class="p">,</span>
                                                                <span class="n">metaKG</span><span class="p">,</span> <span class="n">APInames</span><span class="p">)</span>
    <span class="n">sele_predicates2</span><span class="p">,</span> <span class="n">sele_APIs2</span><span class="p">,</span> <span class="n">API_URLs2</span> <span class="o">=</span> <span class="n">sele_predicates_API</span><span class="p">(</span><span class="n">input_node2_category</span><span class="p">,</span>
                                                                <span class="n">intermediate_categories</span><span class="p">,</span>
                                                                <span class="n">metaKG</span><span class="p">,</span> <span class="n">APInames</span><span class="p">)</span>    

    <span class="n">query_json1</span> <span class="o">=</span> <span class="n">format_query_json</span><span class="p">(</span><span class="n">input_node1_list</span><span class="p">,</span>  <span class="c1"># a list of identifiers for input node1</span>
                                    <span class="p">[],</span>  <span class="c1"># id list for the intermediate node, it can be empty list if only want to query node1</span>
                                    <span class="n">input_node1_category</span><span class="p">,</span>  <span class="c1"># a list of categories of input node1</span>
                                    <span class="n">intermediate_categories</span><span class="p">,</span>  <span class="c1"># a list of categories of the intermediate node</span>
                                    <span class="n">sele_predicates1</span><span class="p">)</span> <span class="c1"># a list of predicates</span>

    <span class="n">query_json2</span> <span class="o">=</span> <span class="n">format_query_json</span><span class="p">(</span><span class="n">input_node2_list</span><span class="p">,</span>  <span class="c1"># a list of identifiers for input node2</span>
                                    <span class="p">[],</span>  <span class="c1"># id list for the intermediate node, it can be empty list if only want to query node2</span>
                                    <span class="n">input_node2_category</span><span class="p">,</span>  <span class="c1"># a list of categories of input node2</span>
                                    <span class="n">intermediate_categories</span><span class="p">,</span>  <span class="c1"># a list of categories of the intermediate node</span>
                                    <span class="n">sele_predicates2</span><span class="p">)</span> <span class="c1"># a list of predicates</span>
    
    <span class="n">result1</span> <span class="o">=</span> <span class="n">translator_query</span><span class="o">.</span><span class="n">parallel_api_query</span><span class="p">(</span><span class="n">query_json</span><span class="o">=</span><span class="n">query_json1</span><span class="p">,</span> 
                             <span class="n">select_APIs</span> <span class="o">=</span> <span class="n">sele_APIs1</span><span class="p">,</span> 
                             <span class="n">APInames</span><span class="o">=</span><span class="n">APInames</span><span class="p">,</span> 
                             <span class="n">API_predicates</span><span class="o">=</span><span class="n">API_predicates</span><span class="p">,</span> 
                             <span class="n">max_workers</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sele_APIs1</span><span class="p">))</span>
    <span class="n">result2</span> <span class="o">=</span> <span class="n">translator_query</span><span class="o">.</span><span class="n">parallel_api_query</span><span class="p">(</span><span class="n">query_json</span><span class="o">=</span><span class="n">query_json2</span><span class="p">,</span> 
                                <span class="n">select_APIs</span> <span class="o">=</span> <span class="n">sele_APIs2</span><span class="p">,</span> 
                                <span class="n">APInames</span><span class="o">=</span><span class="n">APInames</span><span class="p">,</span> 
                                <span class="n">API_predicates</span><span class="o">=</span><span class="n">API_predicates</span><span class="p">,</span> 
                                <span class="n">max_workers</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sele_APIs2</span><span class="p">))</span>

    <span class="n">result_parsed1</span> <span class="o">=</span> <span class="n">parse_KG</span><span class="p">(</span><span class="n">result1</span><span class="p">)</span>
        <span class="c1"># Step 7: Ranking the results. This ranking method is based on the number of unique</span>
        <span class="c1"># primary infores. It can only be used to rank the results with one defined node.</span>
    <span class="n">result_ranked_by_primary_infores1</span> <span class="o">=</span> <span class="n">rank_by_primary_infores</span><span class="p">(</span><span class="n">result_parsed1</span><span class="p">,</span> <span class="n">input_node1_id</span><span class="p">)</span>   <span class="c1"># input_node1_id is the curie id of the</span>

    <span class="n">result_parsed2</span> <span class="o">=</span> <span class="n">parse_KG</span><span class="p">(</span><span class="n">result2</span><span class="p">)</span>
    <span class="n">result_ranked_by_primary_infores2</span> <span class="o">=</span> <span class="n">rank_by_primary_infores</span><span class="p">(</span><span class="n">result_parsed2</span><span class="p">,</span> <span class="n">input_node2_id</span><span class="p">)</span>   <span class="c1"># input_node2_id is the curie id of the</span>

    <span class="n">possible_paths</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result_ranked_by_primary_infores1</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result_ranked_by_primary_infores2</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">])))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of possible paths: &quot;</span><span class="p">,</span> <span class="n">possible_paths</span><span class="p">)</span>

    <span class="n">paths</span> <span class="o">=</span> <span class="n">merge_ranking_by_number_of_infores</span><span class="p">(</span><span class="n">result_ranked_by_primary_infores1</span><span class="p">,</span> <span class="n">result_ranked_by_primary_infores2</span><span class="p">,</span> 
                                            <span class="n">top_n</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
                                            <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                            <span class="n">title_fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,)</span>
    
    <span class="k">return</span> <span class="n">paths</span><span class="p">,</span>  <span class="n">input_node1_id</span><span class="p">,</span> <span class="n">input_node2_id</span><span class="p">,</span> <span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">,</span> <span class="n">result_parsed1</span><span class="p">,</span> <span class="n">result_parsed2</span><span class="p">,</span> <span class="n">result_ranked_by_primary_infores1</span><span class="p">,</span> <span class="n">result_ranked_by_primary_infores2</span></div>


<span class="c1"># used. Dec 5, 2023 (Example_query_one_hop_with_category.ipynb)</span>


<span class="c1"># used. Dec 5, 2023    (Example_query_one_hop_with_category.ipynb)</span>
<div class="viewcode-block" id="parse_KG">
<a class="viewcode-back" href="../../TCT.html#TCT.TCT.parse_KG">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">parse_KG</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    subject_object</span>
<span class="sd">    subject</span>
<span class="sd">    object</span>
<span class="sd">    predicate</span>
<span class="sd">    primary_knowledge_sources</span>
<span class="sd">    aggregator_knowledge_sources</span>
<span class="sd">    subject_predicate_object_primary_knowledge_sources_aggregator_knowledge_sources</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># edited Dec 5, 2023</span>

    <span class="n">result_parsed</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
        
        <span class="n">subject_object</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span>
        <span class="n">object_subject</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span>
        <span class="c1">#result_parsed[&quot;predicate&quot;].append(result[i][&#39;predicate&#39;])</span>
        <span class="c1">#result_parsed[&quot;sources&quot;].append(result[i][&#39;sources&#39;])</span>
        <span class="c1">#result_parsed[&quot;subject&quot;].append(result[i][&#39;subject&#39;])</span>
        <span class="c1">#result_parsed[&quot;object&quot;].append(result[i][&#39;object&#39;])</span>
        <span class="k">if</span> <span class="n">subject_object</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result_parsed</span><span class="p">:</span>
            <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject_object</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject_object</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">]]</span>
            <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject_object</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span>
            <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject_object</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span>
            
            
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">j</span><span class="p">[</span><span class="s1">&#39;resource_role&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;primary_knowledge_source&#39;</span><span class="p">:</span>
                    <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject_object</span><span class="p">][</span><span class="s1">&#39;primary_knowledge_source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="s1">&#39;resource_id&#39;</span><span class="p">]]</span>

                <span class="n">evidence</span> <span class="o">=</span>  <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">j</span><span class="p">[</span><span class="s1">&#39;resource_id&#39;</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">j</span><span class="p">[</span><span class="s1">&#39;resource_role&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;aggregator_knowledge_source&#39;</span><span class="p">:</span>
                    <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject_object</span><span class="p">][</span><span class="s1">&#39;aggregator_knowledge_source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="s1">&#39;resource_id&#39;</span><span class="p">]]</span>
                    <span class="n">evidence</span> <span class="o">=</span> <span class="n">evidence</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">j</span><span class="p">[</span><span class="s1">&#39;resource_id&#39;</span><span class="p">]</span>
            <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject_object</span><span class="p">][</span><span class="s1">&#39;evidence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">evidence</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span> <span class="c1"># subject_object in result_parsed:</span>
            <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject_object</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">j</span><span class="p">[</span><span class="s1">&#39;resource_role&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;primary_knowledge_source&#39;</span><span class="p">:</span>
                    <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject_object</span><span class="p">][</span><span class="s1">&#39;primary_knowledge_source&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="s1">&#39;resource_id&#39;</span><span class="p">])</span>
                    <span class="n">evidence</span> <span class="o">=</span>  <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">j</span><span class="p">[</span><span class="s1">&#39;resource_id&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">j</span><span class="p">[</span><span class="s1">&#39;resource_role&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;aggregator_knowledge_source&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;aggregator_knowledge_source&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject_object</span><span class="p">]:</span>
                        <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject_object</span><span class="p">][</span><span class="s1">&#39;aggregator_knowledge_source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="s1">&#39;resource_id&#39;</span><span class="p">]]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject_object</span><span class="p">][</span><span class="s1">&#39;aggregator_knowledge_source&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="s1">&#39;resource_id&#39;</span><span class="p">])</span>
                    <span class="n">evidence</span> <span class="o">=</span> <span class="n">evidence</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">j</span><span class="p">[</span><span class="s1">&#39;resource_id&#39;</span><span class="p">]</span>
            <span class="n">result_parsed</span><span class="p">[</span><span class="n">subject_object</span><span class="p">][</span><span class="s1">&#39;evidence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evidence</span><span class="p">)</span>

    <span class="k">return</span><span class="p">(</span><span class="n">result_parsed</span><span class="p">)</span></div>



<span class="c1"># parse network results. Dec 10, 2023</span>
<span class="k">def</span><span class="w"> </span><span class="nf">parse_network_result</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">input_node1_list</span><span class="p">):</span>
    <span class="n">dic_nodes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
        <span class="n">subject</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span>
        <span class="nb">object</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span>
        <span class="n">predicate</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">]</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">subject</span> <span class="o">==</span> <span class="nb">object</span><span class="p">:</span>
            <span class="k">continue</span>
        
        <span class="k">if</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">dic_nodes</span><span class="p">:</span>
            <span class="n">dic_nodes</span><span class="p">[</span><span class="n">subject</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dic_nodes</span><span class="p">[</span><span class="n">subject</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">object</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="nb">object</span> <span class="ow">in</span> <span class="n">dic_nodes</span><span class="p">:</span>
            <span class="n">dic_nodes</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dic_nodes</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">subject</span><span class="p">]</span>



    <span class="n">dic_remain_nodes</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">dic_with_input_nodes</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dic_nodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">input_node1_list</span><span class="p">:</span>
            <span class="n">dic_remain_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dic_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dic_remain_nodes</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">dic_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">dic_with_input_nodes</span><span class="p">:</span>
                <span class="n">dic_with_input_nodes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dic_with_input_nodes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dic_with_input_nodes</span><span class="p">:</span>
        <span class="n">dic_with_input_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">dic_with_input_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            



    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dic_with_input_nodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">dic_with_input_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="c1">#</span>
            <span class="c1">#print(i, set(dic_with_input_nodes[i]))</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic_remain_nodes</span><span class="p">:</span>
                <span class="n">dic_remain_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dic_with_input_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>

    <span class="n">dic_remain_nodes_final</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dic_remain_nodes</span><span class="p">:</span>
        <span class="n">dic_remain_nodes_final</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">dic_remain_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">dic_remain_nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>


    <span class="n">subject_nodes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">object_nodes</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dic_remain_nodes_final</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">dic_remain_nodes_final</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">subject_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">object_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>

    <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Subject&#39;</span><span class="p">:</span><span class="n">subject_nodes</span><span class="p">,</span> <span class="s1">&#39;Object&#39;</span><span class="p">:</span><span class="n">object_nodes</span><span class="p">})</span>
    <span class="c1">#result_df.to_csv(&#39;result_df.csv&#39;, index=False)</span>
    <span class="k">return</span> <span class="n">result_df</span>

<div class="viewcode-block" id="rank_by_primary_infores_input_as_list">
<a class="viewcode-back" href="../../TCT.html#TCT.TCT.rank_by_primary_infores_input_as_list">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">rank_by_primary_infores_input_as_list</span><span class="p">(</span><span class="n">result_parsed</span><span class="p">,</span> <span class="n">input_nodes</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Editd Dec 5, 2023&#39;&#39;&#39;</span>
    <span class="n">rank_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">output_nodes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">input_nodes_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Num_of_primary_infores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">type_of_nodes</span>   <span class="o">=</span> <span class="p">[]</span>
    <span class="n">unique_predicates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result_parsed</span><span class="p">:</span>
        <span class="n">curr_predict</span> <span class="o">=</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">]</span>
        <span class="n">subject</span> <span class="o">=</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span>
        <span class="nb">object</span> <span class="o">=</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">input_nodes</span><span class="p">:</span>
            <span class="n">input_nodes_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
            <span class="n">output_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
            <span class="n">type_of_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
            <span class="n">Num_of_primary_infores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result_parsed</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;primary_knowledge_source&#39;</span><span class="p">])))</span>
            <span class="n">unique_predicates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curr_predict</span><span class="p">)</span>
            

        <span class="k">elif</span> <span class="nb">object</span> <span class="ow">in</span> <span class="n">input_nodes</span><span class="p">:</span>
            <span class="n">input_nodes_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
            <span class="n">output_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
            <span class="n">type_of_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;subject&#39;</span><span class="p">)</span>
            <span class="n">unique_predicates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curr_predict</span><span class="p">)</span>
        
            <span class="n">Num_of_primary_infores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result_parsed</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;primary_knowledge_source&#39;</span><span class="p">])))</span>

    <span class="n">colnames</span> <span class="o">=</span> <span class="n">output_nodes</span>
    <span class="n">names</span> <span class="o">=</span> <span class="n">colnames</span>
    <span class="n">dic_id_map</span> <span class="o">=</span> <span class="n">ID_convert_to_preferred_name_nodeNormalizer</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dic_id_map</span><span class="p">:</span>
            <span class="n">new_colnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic_id_map</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_colnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>   

    <span class="n">rank_df</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_nodes</span>
    <span class="n">rank_df</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_colnames</span>
    <span class="n">rank_df</span><span class="p">[</span><span class="s1">&#39;Num_of_primary_infores&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Num_of_primary_infores</span>
    <span class="n">rank_df</span><span class="p">[</span><span class="s1">&#39;type_of_nodes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_of_nodes</span>
    <span class="n">rank_df</span><span class="p">[</span><span class="s1">&#39;unique_predicates&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unique_predicates</span>
    
    <span class="n">rank_df</span><span class="p">[</span><span class="s1">&#39;input_node&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_nodes_list</span>
    
    <span class="n">rank_df_ranked</span> <span class="o">=</span> <span class="n">rank_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Num_of_primary_infores&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">rank_df_ranked</span><span class="p">)</span></div>




<span class="c1"># parse results to a dictionary. Dec 5, 2023</span>
<span class="c1"># used. Dec 5, 2023 (Example_query_one_hop_with_category.ipynb)</span>
<div class="viewcode-block" id="rank_by_primary_infores">
<a class="viewcode-back" href="../../TCT.html#TCT.TCT.rank_by_primary_infores">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">rank_by_primary_infores</span><span class="p">(</span><span class="n">result_parsed</span><span class="p">,</span> <span class="n">input_node</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Editd Dec 5, 2023&#39;&#39;&#39;</span>
    <span class="n">rank_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">output_nodes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Num_of_primary_infores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">type_of_nodes</span>   <span class="o">=</span> <span class="p">[]</span>
    <span class="n">unique_predicates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result_parsed</span><span class="p">:</span>
        <span class="n">curr_predict</span> <span class="o">=</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">]</span>
        <span class="n">subject</span> <span class="o">=</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span>
        <span class="nb">object</span> <span class="o">=</span> <span class="n">result_parsed</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">subject</span> <span class="o">==</span> <span class="n">input_node</span><span class="p">:</span>
            <span class="n">output_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
            <span class="n">type_of_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
            <span class="n">Num_of_primary_infores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result_parsed</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;primary_knowledge_source&#39;</span><span class="p">])))</span>
            <span class="n">unique_predicates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curr_predict</span><span class="p">)</span>
            

        <span class="k">elif</span> <span class="nb">object</span> <span class="o">==</span> <span class="n">input_node</span><span class="p">:</span>
            <span class="n">output_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
            <span class="n">type_of_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;subject&#39;</span><span class="p">)</span>
            <span class="n">unique_predicates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curr_predict</span><span class="p">)</span>
        
            <span class="n">Num_of_primary_infores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result_parsed</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;primary_knowledge_source&#39;</span><span class="p">])))</span>

    <span class="n">colnames</span> <span class="o">=</span> <span class="n">output_nodes</span>
    <span class="n">names</span> <span class="o">=</span> <span class="n">colnames</span>
    <span class="n">dic_id_map</span> <span class="o">=</span> <span class="n">ID_convert_to_preferred_name_nodeNormalizer</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dic_id_map</span><span class="p">:</span>
            <span class="n">new_colnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic_id_map</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_colnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>   

    <span class="n">rank_df</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_nodes</span>
    <span class="n">rank_df</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_colnames</span>
    <span class="n">rank_df</span><span class="p">[</span><span class="s1">&#39;Num_of_primary_infores&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Num_of_primary_infores</span>
    <span class="n">rank_df</span><span class="p">[</span><span class="s1">&#39;type_of_nodes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_of_nodes</span>
    <span class="n">rank_df</span><span class="p">[</span><span class="s1">&#39;unique_predicates&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unique_predicates</span>
    
    
    
    <span class="n">rank_df_ranked</span> <span class="o">=</span> <span class="n">rank_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Num_of_primary_infores&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">rank_df_ranked</span><span class="p">)</span></div>




<span class="c1"># used. Dec 5, 2023 (Example_query_rank_the_path.ipynb)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">merge_by_ranking_index</span><span class="p">(</span><span class="n">result_ranked_by_primary_infores</span><span class="p">,</span>
                           <span class="n">result_ranked_by_primary_infores2</span><span class="p">,</span> 
                           <span class="n">top_n</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                           <span class="n">title_fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
                           <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
                           <span class="p">):</span>

    
    <span class="n">dic_rank1</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">result_ranked_by_primary_infores</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">dic_rank1</span><span class="p">[</span><span class="n">result_ranked_by_primary_infores</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="n">result_ranked_by_primary_infores</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">dic_rank2</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">result_ranked_by_primary_infores2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">dic_rank2</span><span class="p">[</span><span class="n">result_ranked_by_primary_infores2</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="n">result_ranked_by_primary_infores2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">merged_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">dic_rank1</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">dic_rank2</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="n">dic_merged_rank</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">merged_nodes</span><span class="p">:</span>
        <span class="n">dic_merged_rank</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">dic_rank1</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">*</span> <span class="n">dic_rank2</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>

    <span class="n">result_ranked</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">dic_merged_rank</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">])</span>
    <span class="n">result_ranked</span> <span class="o">=</span> <span class="n">result_ranked</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">result_ranked</span> <span class="o">=</span> <span class="n">result_ranked</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">result_ranked</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]</span>
    <span class="n">result_xy_sorted</span> <span class="o">=</span> <span class="n">result_ranked</span>
    <span class="n">result_xy_sorted</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">result_ranked</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">]</span>

    <span class="c1">#convert = False</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="n">result_xy_sorted</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
    <span class="n">names</span> <span class="o">=</span> <span class="n">colnames</span>
    <span class="n">dic_id_map</span> <span class="o">=</span> <span class="n">ID_convert_to_preferred_name_nodeNormalizer</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dic_id_map</span><span class="p">:</span>
            <span class="n">new_colnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic_id_map</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_colnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>   

    <span class="n">result_xy_sorted</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">new_colnames</span>
    <span class="n">result_xy_sorted</span> <span class="o">=</span> <span class="n">result_xy_sorted</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">result_xy_sorted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">top_n</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">result_xy_sorted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">top_n</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Ranking score&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">title_fontsize</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="c1">#plt.show()</span>

    <span class="k">return</span> <span class="n">result_xy_sorted</span>



<span class="k">def</span><span class="w"> </span><span class="nf">merge_ranking_by_number_of_infores</span><span class="p">(</span><span class="n">result_ranked_by_primary_infores</span><span class="p">,</span> 
                                       <span class="n">result_ranked_by_primary_infores1</span><span class="p">,</span> 
                                       <span class="n">top_n</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
                                       <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
                                       <span class="n">title_fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
                                       <span class="n">output_png</span> <span class="o">=</span> <span class="s2">&quot;NE_heatmap.png&quot;</span>
                                       <span class="p">):</span>
    <span class="n">overlapped</span> <span class="o">=</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result_ranked_by_primary_infores1</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result_ranked_by_primary_infores</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">])))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">result_ranked_by_primary_infores</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">result_ranked_by_primary_infores</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">overlapped</span><span class="p">)]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">result_ranked_by_primary_infores1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">result_ranked_by_primary_infores1</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">overlapped</span><span class="p">)]</span>
    <span class="n">dic_x</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">dic_x</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;output_node&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Num_of_primary_infores&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Num_of_primary_infores&#39;</span><span class="p">])</span>

    <span class="n">dic_y</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">dic_y</span><span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;output_node&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Num_of_primary_infores&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="s1">&#39;Num_of_primary_infores&#39;</span><span class="p">])</span>

    <span class="n">predicts_list1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">predicts_list2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dic_xy</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">overlapped</span><span class="p">:</span>
        <span class="c1">#print(result_ranked_by_primary_infores[result_ranked_by_primary_infores[&#39;output_node&#39;] == i][&#39;unique_predicates&#39;])</span>
        <span class="n">dic_xy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dic_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dic_y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">predicts_list1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result_ranked_by_primary_infores</span><span class="p">[</span><span class="n">result_ranked_by_primary_infores</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">][</span><span class="s1">&#39;unique_predicates&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
        <span class="n">predicts_list2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">result_ranked_by_primary_infores1</span><span class="p">[</span><span class="n">result_ranked_by_primary_infores1</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">][</span><span class="s1">&#39;unique_predicates&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>

    <span class="n">result_xy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">dic_xy</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">])</span>
    <span class="n">result_xy</span><span class="p">[</span><span class="s1">&#39;output_node&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_xy</span><span class="o">.</span><span class="n">index</span>
    <span class="c1"># convert the output_node to preferred name</span>

    
        
    <span class="c1">#result_xy[&quot;output_node_name&quot;] = new_colnames</span>
    <span class="n">result_xy</span><span class="p">[</span><span class="s1">&#39;predictes1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predicts_list1</span>
    <span class="n">result_xy</span><span class="p">[</span><span class="s1">&#39;predictes2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predicts_list2</span>

    <span class="n">result_xy_sorted</span> <span class="o">=</span> <span class="n">result_xy</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">convert</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="n">result_xy_sorted</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

    <span class="n">names</span> <span class="o">=</span> <span class="n">colnames</span>
    <span class="n">dic_id_map</span> <span class="o">=</span> <span class="n">ID_convert_to_preferred_name_nodeNormalizer</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dic_id_map</span><span class="p">:</span>
            <span class="n">new_colnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic_id_map</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_colnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>   


    <span class="n">result_xy_sorted</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">new_colnames</span>
    <span class="n">result_xy_sorted</span><span class="p">[</span><span class="s1">&#39;output_node_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_colnames</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">result_xy_sorted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">top_n</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">result_xy_sorted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">top_n</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">]</span>

    <span class="n">plot_path_bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">title_fontsize</span><span class="p">,</span> <span class="n">output_png</span><span class="o">=</span><span class="n">output_png</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result_xy_sorted</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_path_bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                  <span class="n">y</span><span class="p">,</span>
                    <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
                    <span class="n">title_fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                    <span class="n">output_png</span><span class="o">=</span><span class="s2">&quot;NE_heatmap.png&quot;</span><span class="p">):</span>
    <span class="c1">#matplotlib.use(&#39;Agg&#39;)</span>
    
    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Bridging nodes&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Ranking score&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">title_fontsize</span><span class="p">)</span>
    <span class="c1"># save the figure</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_png</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>


<span class="c1"># Sri-name-resolver  Used Dec 5, 2023 (Example_query_one_hop_with_category.ipynb)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_curie</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://name-lookup.transltr.io/lookup&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;string&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="s1">&#39;autocomplete&#39;</span><span class="p">:</span> <span class="kc">False</span>
    <span class="p">})</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;curie&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># annotate gene pairs or a list of genes. Feb 25, 2024</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_pair_annotation</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">input_node_list</span><span class="p">):</span>
    <span class="n">pairs_found</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        
        <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">input_node_list</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">input_node_list</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]:</span>
            <span class="n">pairs_found</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pairs_found</span>


<span class="k">def</span><span class="w"> </span><span class="nf">parse_pair_annotation</span><span class="p">(</span><span class="n">pairs_found</span><span class="p">,</span> <span class="n">input_node_list</span><span class="p">):</span>
    <span class="n">edge_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">names</span> <span class="o">=</span> <span class="n">ID_convert_to_preferred_name_nodeNormalizer</span><span class="p">(</span><span class="n">input_node_list</span><span class="p">)</span>
    <span class="n">dic_names</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">input_node_list</span><span class="p">:</span>
        <span class="n">dic_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pairs_found</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">primary_source</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">pairs_found</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">source</span><span class="p">[</span><span class="s1">&#39;resource_role&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;primary_knowledge_source&#39;</span><span class="p">:</span>
                <span class="n">primary_source</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="s1">&#39;resource_id&#39;</span><span class="p">]</span>
                <span class="k">break</span>
        <span class="n">edge_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">pairs_found</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">],</span><span class="n">dic_names</span><span class="p">[</span><span class="n">pairs_found</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]],</span>  <span class="n">pairs_found</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">],</span> <span class="n">pairs_found</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">],</span> <span class="n">dic_names</span><span class="p">[</span><span class="n">pairs_found</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]],</span> <span class="n">primary_source</span> <span class="p">])</span>
    <span class="k">return</span> <span class="n">edge_list</span>

<span class="c1">#used</span>

<span class="k">def</span><span class="w"> </span><span class="nf">query_chatGPT4</span><span class="p">(</span><span class="n">customized_input</span><span class="p">):</span>
    <span class="n">message</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">customized_input</span><span class="p">}]</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">openai</span><span class="o">.</span><span class="n">ChatCompletion</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="c1">#model=&quot;gpt-3.5-turbo&quot;,</span>
    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-4&quot;</span><span class="p">,</span>
    <span class="n">max_tokens</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span>
    <span class="n">messages</span> <span class="o">=</span> <span class="n">message</span><span class="p">)</span>

    <span class="c1">#print(len(response.choices[0].message.content.split(&quot; &quot;)))</span>

    <span class="k">return</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">query_chatGPT</span><span class="p">(</span><span class="n">customized_input</span><span class="p">):</span>
    <span class="n">message</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">customized_input</span><span class="p">}]</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">openai</span><span class="o">.</span><span class="n">ChatCompletion</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">,</span>
    <span class="c1">#model=&quot;gpt-4&quot;,</span>
    <span class="n">max_tokens</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span>
    <span class="n">messages</span> <span class="o">=</span> <span class="n">message</span><span class="p">)</span>

    <span class="c1">#print(len(response.choices[0].message.content.split(&quot; &quot;)))</span>

    <span class="k">return</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="c1"># to be removed</span>
<span class="k">def</span><span class="w"> </span><span class="nf">query_KP_all</span><span class="p">(</span><span class="n">subject_ids</span><span class="p">,</span> <span class="n">object_ids</span><span class="p">,</span> <span class="n">subject_categories</span><span class="p">,</span> <span class="n">object_categories</span><span class="p">,</span> <span class="n">predicates</span><span class="p">,</span> <span class="n">API_list</span><span class="p">,</span><span class="n">metaKG</span><span class="p">,</span> <span class="n">APInames</span><span class="p">):</span>

    <span class="c1">#APInames = API_list</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">API_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">API_list</span> <span class="o">=</span> <span class="n">select_API</span><span class="p">(</span><span class="n">subject_categories</span><span class="p">,</span><span class="n">object_categories</span><span class="p">,</span><span class="n">metaKG</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">API_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">APInames</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="n">result_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">result_concept</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># Query individual KP</span>
    
    <span class="c1"># Needs parallel query</span>
    

    <span class="k">for</span> <span class="n">API_sele</span> <span class="ow">in</span> <span class="n">API_list</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">API_sele</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">predicates</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">predicates_used</span> <span class="o">=</span> <span class="n">select_predicates_inKP</span><span class="p">(</span><span class="n">subject_categories</span><span class="p">,</span><span class="n">object_categories</span><span class="p">,</span><span class="n">API_sele</span><span class="p">,</span><span class="n">metaKG</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">predicates_used</span> <span class="o">=</span> <span class="n">predicates</span>
        
        <span class="n">query_json</span> <span class="o">=</span> <span class="n">format_query_json</span><span class="p">(</span><span class="n">subject_ids</span><span class="p">,</span> <span class="n">object_ids</span><span class="p">,</span> <span class="n">subject_categories</span><span class="p">,</span> <span class="n">object_categories</span><span class="p">,</span> <span class="n">predicates_used</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">query_json</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">kg_output</span> <span class="o">=</span> <span class="n">query_KP</span><span class="p">(</span><span class="n">APInames</span><span class="p">[</span><span class="n">API_sele</span><span class="p">],</span><span class="n">query_json</span><span class="p">)</span>
            
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Connection Error&quot;</span><span class="p">)</span>
            <span class="n">kg_output</span> <span class="o">=</span> <span class="kc">None</span>
            
        <span class="k">if</span> <span class="n">kg_output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># if kg_output is  a dictionary</span>

            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">kg_output</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span> <span class="ow">and</span> <span class="s1">&#39;nodes&#39;</span> <span class="ow">in</span> <span class="n">kg_output</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kg_output</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">])</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Found: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kg_output</span><span class="p">[</span><span class="s1">&#39;edges&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> <span class="o">+</span> <span class="s2">&quot; nodes in &quot;</span> <span class="o">+</span> <span class="n">API_sele</span><span class="p">)</span> 
                    <span class="nb">print</span><span class="p">(</span><span class="n">predicates_used</span><span class="p">)</span>
                    <span class="n">result_concept</span><span class="p">[</span><span class="n">API_sele</span><span class="p">]</span> <span class="o">=</span> <span class="n">predicates_used</span>
                    <span class="n">result_dict</span><span class="p">[</span><span class="n">API_sele</span><span class="p">]</span> <span class="o">=</span> <span class="n">kg_output</span>
    <span class="k">return</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">result_concept</span><span class="p">)</span>

<span class="c1"># to be removed</span>
<span class="k">def</span><span class="w"> </span><span class="nf">parse_result_old</span><span class="p">(</span> <span class="n">API_keys_sele</span><span class="p">,</span> <span class="n">API_keys_Not_include</span><span class="p">,</span> <span class="n">predicates_forAnalysis</span><span class="p">,</span><span class="n">result_dic</span><span class="p">):</span>
    <span class="n">Temp_APIkey</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Temp_subject_key</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Temp_object_key</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Temp_predicate_key</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Temp_infores_key</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">API_keys_forAnalysis</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">ALL_APIs_in_result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">result_dic</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ALL_APIs_in_result</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">API_keys_sele</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">API_keys_forAnalysis</span> <span class="o">=</span> <span class="n">ALL_APIs_in_result</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">API_keys_forAnalysis</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ALL_APIs_in_result</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">API_keys_sele</span><span class="p">)))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">API_keys_Not_include</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">API_keys_forAnalysis</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">API_keys_forAnalysis</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">API_keys_Not_include</span><span class="p">))</span>


    <span class="nb">print</span><span class="p">(</span><span class="n">API_keys_forAnalysis</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">API_key</span> <span class="ow">in</span> <span class="n">API_keys_forAnalysis</span><span class="p">:</span>
        <span class="n">cur_API_outputKeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">result_dic</span><span class="p">[</span><span class="n">API_key</span><span class="p">][</span><span class="s1">&#39;edges&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cur_API_outputKeys</span><span class="p">)):</span>
            <span class="n">curr_key</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">curr_graph</span> <span class="o">=</span> <span class="p">(</span><span class="n">result_dic</span><span class="p">[</span><span class="n">API_key</span><span class="p">][</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="n">cur_API_outputKeys</span><span class="p">[</span><span class="n">curr_key</span><span class="p">]])</span>
            <span class="n">predicate</span> <span class="o">=</span> <span class="p">(</span><span class="n">curr_graph</span><span class="p">[</span><span class="s1">&#39;predicate&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">predicate</span> <span class="o">!=</span> <span class="s2">&quot;biolink:subclass_of&quot;</span><span class="p">:</span>
                <span class="n">infores</span> <span class="o">=</span> <span class="p">(</span><span class="n">curr_graph</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;resource_id&#39;</span><span class="p">])</span>
                <span class="n">subject</span> <span class="o">=</span> <span class="p">(</span><span class="n">curr_graph</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">subject</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;CL:&quot;</span><span class="p">):</span>
                    <span class="n">subject</span> <span class="o">=</span> <span class="s2">&quot;CL&quot;</span> <span class="o">+</span> <span class="n">subject</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

                <span class="nb">object</span> <span class="o">=</span> <span class="p">(</span><span class="n">curr_graph</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">object</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;CL:&quot;</span><span class="p">):</span>
                    <span class="nb">object</span> <span class="o">=</span> <span class="s2">&quot;CL&quot;</span> <span class="o">+</span> <span class="nb">object</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                
                <span class="c1">#exclude subclass_of</span>
                
                <span class="n">Temp_APIkey</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">API_key</span><span class="p">)</span>
                <span class="n">Temp_subject_key</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
                <span class="n">Temp_object_key</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
                <span class="n">Temp_predicate_key</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span>
                <span class="n">Temp_infores_key</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">infores</span><span class="p">)</span>
            
            <span class="c1">#Temp_APIkey.append(API_key)</span>
            <span class="c1">#Temp_subject_key.append(subject)</span>
            <span class="c1">#Temp_object_key.append(object)</span>
            <span class="c1">#Temp_predicate_key.append(predicate)</span>
            <span class="c1">#Temp_infores_key.append(infores)</span>

    <span class="n">Temp_result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;API&#39;</span><span class="p">:</span> <span class="n">Temp_APIkey</span><span class="p">,</span> 
                                   <span class="s1">&#39;Subject&#39;</span><span class="p">:</span> <span class="n">Temp_subject_key</span><span class="p">,</span>
                                   <span class="s2">&quot;Object&quot;</span><span class="p">:</span><span class="n">Temp_object_key</span><span class="p">,</span> 
                                   <span class="s2">&quot;Predicate&quot;</span><span class="p">:</span><span class="n">Temp_predicate_key</span><span class="p">,</span> 
                                   <span class="s2">&quot;Infores&quot;</span><span class="p">:</span><span class="n">Temp_infores_key</span><span class="p">})</span>

    <span class="n">Temp_result_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">Temp_result_df</span> <span class="o">=</span> <span class="n">Temp_result_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Temp_result_df</span><span class="p">[</span><span class="s1">&#39;API&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">API_keys_forAnalysis</span><span class="p">)]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">predicates_forAnalysis</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">Temp_result_df</span> <span class="o">=</span> <span class="n">Temp_result_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Temp_result_df</span><span class="p">[</span><span class="s1">&#39;Predicate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">predicates_forAnalysis</span><span class="p">)]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Temp_result_df</span><span class="p">)</span>

<span class="c1"># to be removed</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ranking_result_by_predicates_object</span><span class="p">(</span><span class="n">Temp_result_df</span><span class="p">):</span>
    <span class="n">object_val_list</span> <span class="o">=</span> <span class="n">Temp_result_df</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">object_val_value</span> <span class="o">=</span> <span class="n">Temp_result_df</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    
    <span class="n">dic_rank</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">object_val_list</span><span class="p">)):</span>
        <span class="n">dic_rank</span><span class="p">[</span><span class="n">object_val_list</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">object_val_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
  

    <span class="n">sorted_dic</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dic_rank</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sorted_dic</span><span class="p">)</span>

<span class="c1"># to be removed</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ranking_result_by_predicates_subject</span><span class="p">(</span><span class="n">Temp_result_df</span><span class="p">):</span>
    <span class="n">subject_val_list</span> <span class="o">=</span> <span class="n">Temp_result_df</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">subject_val_list</span> <span class="o">=</span> <span class="n">Temp_result_df</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">dic_rank</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">subject_val_list</span><span class="p">)):</span>
        <span class="n">dic_rank</span><span class="p">[</span><span class="n">subject_val_list</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">subject_val_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
  

    <span class="n">sorted_dic</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dic_rank</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sorted_dic</span><span class="p">)</span>


<span class="c1"># to be removed</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_ranking_by_predicates</span><span class="p">(</span><span class="n">sorted_dic</span><span class="p">,</span> <span class="n">Temp_result_df</span><span class="p">,</span> <span class="n">Top</span><span class="p">):</span>
    <span class="c1">#item_ranking = []</span>
    <span class="n">dic_ranking</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">Top</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_dic</span><span class="p">):</span>
        <span class="n">Top</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_dic</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Top</span><span class="p">):</span>
        <span class="c1">#item_ranking.append(sorted_dic[i][0])</span>
        <span class="n">sele_result</span> <span class="o">=</span> <span class="n">sorted_dic</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dic_ranking</span><span class="p">[</span><span class="n">sorted_dic</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Temp_result_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Temp_result_df</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">sele_result</span><span class="p">])],</span> <span class="n">Temp_result_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Temp_result_df</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">sele_result</span><span class="p">])]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s1">&#39;Predicate&#39;</span><span class="p">])))</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">dic_ranking</span><span class="p">)</span>

<span class="c1"># to be removed</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_ranking_by_infores</span><span class="p">(</span><span class="n">sorted_dic</span><span class="p">,</span> <span class="n">Temp_result_df</span><span class="p">,</span> <span class="n">Top</span><span class="p">):</span>
    <span class="c1">#item_ranking = []</span>
    <span class="n">dic_ranking</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">Top</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_dic</span><span class="p">):</span>
        <span class="n">Top</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_dic</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Top</span><span class="p">):</span>
        <span class="c1">#item_ranking.append(sorted_dic[i][0])</span>
        <span class="n">sele_result</span> <span class="o">=</span> <span class="n">sorted_dic</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dic_ranking</span><span class="p">[</span><span class="n">sorted_dic</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Temp_result_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Temp_result_df</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">sele_result</span><span class="p">])],</span> <span class="n">Temp_result_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Temp_result_df</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">sele_result</span><span class="p">])]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s1">&#39;Infores&#39;</span><span class="p">])))</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">dic_ranking</span><span class="p">)</span>

<span class="c1"># to be removed</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_ranking_by_kp</span><span class="p">(</span><span class="n">sorted_dic</span><span class="p">,</span> <span class="n">Temp_result_df</span><span class="p">,</span> <span class="n">Top</span><span class="p">):</span>
    <span class="c1">#item_ranking = []</span>
    <span class="n">dic_ranking</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">Top</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_dic</span><span class="p">):</span>
        <span class="n">Top</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_dic</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Top</span><span class="p">):</span>
        <span class="c1">#item_ranking.append(sorted_dic[i][0])</span>
        <span class="n">sele_result</span> <span class="o">=</span> <span class="n">sorted_dic</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dic_ranking</span><span class="p">[</span><span class="n">sorted_dic</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Temp_result_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Temp_result_df</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">sele_result</span><span class="p">])],</span> <span class="n">Temp_result_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Temp_result_df</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">sele_result</span><span class="p">])]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s1">&#39;API&#39;</span><span class="p">])))</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">dic_ranking</span><span class="p">)</span>

<span class="c1"># to be revised</span>
<span class="k">def</span><span class="w"> </span><span class="nf">connecting_two_dots_two_hops</span><span class="p">(</span><span class="n">sorted_dic1</span><span class="p">,</span> <span class="n">sorted_dic</span><span class="p">):</span>
    <span class="n">intermediate</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">normalized_rank</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">rank1</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sorted_dic1</span><span class="p">:</span>
        <span class="n">gene1</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">rank1</span> <span class="o">=</span> <span class="n">rank1</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">rank2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">sorted_dic</span><span class="p">:</span>
            <span class="n">gene2</span> <span class="o">=</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">rank2</span> <span class="o">=</span> <span class="n">rank2</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">gene1</span> <span class="o">==</span> <span class="n">gene2</span><span class="p">:</span>
                <span class="n">normlized_rank1</span> <span class="o">=</span> <span class="n">rank1</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sorted_dic1</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">normlized_rank2</span> <span class="o">=</span> <span class="n">rank2</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sorted_dic</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">new_order</span> <span class="o">=</span> <span class="n">normlized_rank1</span> <span class="o">*</span> <span class="n">normlized_rank2</span>
                <span class="n">intermediate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gene2</span><span class="p">)</span>
                <span class="n">normalized_rank</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_order</span><span class="p">)</span>

    <span class="n">res_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;node&quot;</span><span class="p">:</span><span class="n">intermediate</span><span class="p">,</span> <span class="s2">&quot;normalized_rank&quot;</span><span class="p">:</span><span class="n">normalized_rank</span><span class="p">})</span>
    <span class="n">res_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;normalized_rank&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">res_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span><span class="p">(</span><span class="n">res_df</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">select_result_to_analysis</span><span class="p">(</span><span class="n">sele_genes</span><span class="p">,</span><span class="n">Temp_result_df</span><span class="p">,</span> <span class="n">Temp_result_df1</span> <span class="p">):</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">sele_genes</span><span class="p">)</span>
    <span class="n">for_plot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Temp_result_df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Temp_result_df1</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sele_genes</span><span class="p">)],</span>
            <span class="n">Temp_result_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Temp_result_df</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sele_genes</span><span class="p">)]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span><span class="p">(</span><span class="n">for_plot</span><span class="p">)</span>

<span class="c1"># need revision</span>
<span class="k">def</span><span class="w"> </span><span class="nf">find_path_by_two_ends</span><span class="p">(</span><span class="n">subject1_ids</span><span class="p">,</span> 
                          <span class="n">subject1_categories</span><span class="p">,</span> 
                          <span class="n">predicates1</span><span class="p">,</span>
                          <span class="n">object_categories</span><span class="p">,</span>
                          <span class="n">subject2_ids</span><span class="p">,</span> 
                          <span class="n">subject2_categories</span><span class="p">,</span>
                          <span class="n">predicates2</span><span class="p">,</span>
                          <span class="n">API_list1</span><span class="p">,</span>
                          <span class="n">API_list2</span><span class="p">,</span>
                          <span class="n">API1_keys_forAnalysis</span><span class="p">,</span>
                          <span class="n">API1_keys_NotforAnalysis</span><span class="p">,</span>
                          <span class="n">API2_keys_forAnalysis</span><span class="p">,</span>
                          <span class="n">API2_keys_NotforAnalysis</span><span class="p">,</span>
                          <span class="n">metaKG</span><span class="p">,</span>
                          <span class="n">APInames</span>
                          <span class="p">):</span>
    
    <span class="n">result_dic_node1</span><span class="p">,</span> <span class="n">result_concept_node1</span> <span class="o">=</span> <span class="n">query_KP_all</span><span class="p">(</span><span class="n">subject1_ids</span><span class="p">,</span> <span class="p">[],</span> <span class="n">subject1_categories</span><span class="p">,</span> <span class="n">object_categories</span><span class="p">,</span> <span class="n">predicates1</span><span class="p">,</span> <span class="n">API_list1</span><span class="p">,</span> <span class="n">metaKG</span><span class="p">,</span> <span class="n">APInames</span><span class="p">)</span>
    <span class="n">result_dic_node2</span><span class="p">,</span> <span class="n">result_concept_node2</span> <span class="o">=</span> <span class="n">query_KP_all</span><span class="p">(</span><span class="n">subject2_ids</span><span class="p">,</span> <span class="p">[],</span> <span class="n">subject2_categories</span><span class="p">,</span> <span class="n">object_categories</span><span class="p">,</span> <span class="n">predicates2</span><span class="p">,</span> <span class="n">API_list2</span><span class="p">,</span> <span class="n">metaKG</span><span class="p">,</span> <span class="n">APInames</span><span class="p">)</span>

    
    <span class="n">Temp_result_df1</span> <span class="o">=</span> <span class="n">parse_result</span><span class="p">(</span><span class="n">API1_keys_forAnalysis</span><span class="p">,</span><span class="n">API1_keys_NotforAnalysis</span><span class="p">,</span> <span class="n">result_concept_node1</span><span class="p">,</span> <span class="n">result_dic_node1</span><span class="p">)</span>
    <span class="n">sorted_dic1</span> <span class="o">=</span> <span class="n">ranking_result_by_predicates_object</span><span class="p">(</span><span class="n">Temp_result_df1</span><span class="p">)</span>

    <span class="n">dic_ranking1</span> <span class="o">=</span> <span class="n">get_ranking_by_infores</span><span class="p">(</span><span class="n">sorted_dic1</span><span class="p">,</span> <span class="n">Temp_result_df1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

    <span class="n">Temp_result_df2</span> <span class="o">=</span> <span class="n">parse_result</span><span class="p">(</span><span class="n">API2_keys_forAnalysis</span><span class="p">,</span><span class="n">API2_keys_NotforAnalysis</span><span class="p">,</span> <span class="n">result_concept_node2</span><span class="p">,</span> <span class="n">result_dic_node2</span><span class="p">)</span>
    <span class="n">sorted_dic2</span> <span class="o">=</span> <span class="n">ranking_result_by_predicates_object</span><span class="p">(</span><span class="n">Temp_result_df2</span><span class="p">)</span>

    <span class="n">dic_ranking2</span> <span class="o">=</span> <span class="n">get_ranking_by_infores</span><span class="p">(</span><span class="n">sorted_dic2</span><span class="p">,</span> <span class="n">Temp_result_df2</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    
    <span class="n">connection_nodes_df</span> <span class="o">=</span> <span class="n">connecting_two_dots_two_hops</span><span class="p">(</span><span class="n">sorted_dic1</span><span class="p">,</span> <span class="n">sorted_dic2</span><span class="p">)</span>

    <span class="c1"># bind all results in to a dictionary</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;connection_nodes_df&quot;</span><span class="p">:</span><span class="n">connection_nodes_df</span><span class="p">,</span>
              <span class="s2">&quot;dic_ranking1&quot;</span><span class="p">:</span><span class="n">dic_ranking1</span><span class="p">,</span>
              <span class="s2">&quot;dic_ranking2&quot;</span><span class="p">:</span><span class="n">dic_ranking2</span><span class="p">,</span>
              <span class="s2">&quot;Temp_result_df1&quot;</span><span class="p">:</span><span class="n">Temp_result_df1</span><span class="p">,</span>
              <span class="s2">&quot;Temp_result_df2&quot;</span><span class="p">:</span><span class="n">Temp_result_df2</span><span class="p">,</span>
              <span class="s2">&quot;result_dic_node1&quot;</span><span class="p">:</span><span class="n">result_dic_node1</span><span class="p">,</span>
              <span class="s2">&quot;result_dic_node2&quot;</span><span class="p">:</span><span class="n">result_dic_node2</span><span class="p">,</span>
              <span class="s2">&quot;result_concept_node1&quot;</span><span class="p">:</span><span class="n">result_concept_node1</span><span class="p">,</span>
              <span class="s2">&quot;result_concept_node2&quot;</span><span class="p">:</span><span class="n">result_concept_node2</span><span class="p">}</span>

    <span class="c1">#return(connection_nodes_df, dic_ranking1, dic_ranking2, Temp_result_df1, Temp_result_df2,result_dic_node1, result_dic_node2, result_concept_node1, result_concept_node2)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">select_result_to_analysis</span><span class="p">(</span><span class="n">sele_genes</span><span class="p">,</span><span class="n">Temp_result_df1</span><span class="p">,</span> <span class="n">Temp_result_df2</span> <span class="p">):</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;selected_path: &quot;</span><span class="o">+</span> <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sele_genes</span><span class="p">))</span>
    <span class="n">for_plot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>  <span class="n">Temp_result_df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Temp_result_df1</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sele_genes</span><span class="p">)],</span>
                            <span class="n">Temp_result_df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Temp_result_df2</span><span class="p">[</span><span class="s1">&#39;Object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sele_genes</span><span class="p">)]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span><span class="p">(</span><span class="n">for_plot</span><span class="p">)</span>



<span class="k">def</span><span class="w"> </span><span class="nf">plot_graph_by_predicates</span><span class="p">(</span><span class="n">for_plot</span><span class="p">):</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_pandas_edgelist</span><span class="p">(</span><span class="n">for_plot</span><span class="p">,</span> 
                                <span class="n">source</span><span class="o">=</span><span class="s1">&#39;Subject&#39;</span><span class="p">,</span>
                                <span class="n">target</span><span class="o">=</span><span class="s1">&#39;Object&#39;</span><span class="p">,</span> 
                                <span class="n">edge_attr</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Predicate&quot;</span><span class="p">],</span> 
                                <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">)</span>


    <span class="n">graph_style</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;node[id]&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="p">{</span>
                                  <span class="s1">&#39;font-family&#39;</span><span class="p">:</span> <span class="s1">&#39;helvetica&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;font-size&#39;</span><span class="p">:</span> <span class="s1">&#39;14px&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;text-valign&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;data(id)&#39;</span><span class="p">,</span>
                        <span class="p">}},</span>
                        <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;node&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="p">{</span>
                             <span class="s1">&#39;background-color&#39;</span><span class="p">:</span> <span class="s1">&#39;lightblue&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;shape&#39;</span><span class="p">:</span> <span class="s1">&#39;round-rectangle&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;5em&#39;</span><span class="p">,</span>
                         <span class="p">}},</span>
                        <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;edge[Predicate]&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="p">{</span>
                             <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;data(Predicate)&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;font-size&#39;</span><span class="p">:</span> <span class="s1">&#39;12px&#39;</span><span class="p">,</span>
                         <span class="p">}},</span>
                        <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;edge.directed&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;curve-style&quot;</span><span class="p">:</span> <span class="s2">&quot;bezier&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;target-arrow-shape&quot;</span><span class="p">:</span> <span class="s2">&quot;triangle&quot;</span><span class="p">,</span>
                        <span class="p">}},</span>
                       <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;edge&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;curve-style&quot;</span><span class="p">:</span> <span class="s2">&quot;bezier&quot;</span><span class="p">,</span>
                        <span class="p">}},</span>

                    <span class="p">]</span>

    <span class="n">undirected</span> <span class="o">=</span> <span class="n">ipycytoscape</span><span class="o">.</span><span class="n">CytoscapeWidget</span><span class="p">()</span>
    <span class="n">undirected</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_graph_from_networkx</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
    <span class="n">undirected</span><span class="o">.</span><span class="n">set_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Path&#39;</span><span class="p">,</span> <span class="n">nodeSpacing</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">edgeLengthVal</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">undirected</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">graph_style</span><span class="p">)</span>

    <span class="n">display</span><span class="p">(</span><span class="n">undirected</span><span class="p">)</span>
    <span class="k">return</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_graph_by_infores</span><span class="p">(</span><span class="n">for_plot</span><span class="p">):</span>
        
    <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_pandas_edgelist</span><span class="p">(</span><span class="n">for_plot</span><span class="p">,</span> 
                                    <span class="n">source</span><span class="o">=</span><span class="s1">&#39;Subject&#39;</span><span class="p">,</span>
                                    <span class="n">target</span><span class="o">=</span><span class="s1">&#39;Object&#39;</span><span class="p">,</span> 
                                    <span class="n">edge_attr</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Infores&quot;</span><span class="p">],</span> 
                                    <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">)</span>


    <span class="n">graph_style</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;node[id]&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="p">{</span>
                                    <span class="s1">&#39;font-family&#39;</span><span class="p">:</span> <span class="s1">&#39;helvetica&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;font-size&#39;</span><span class="p">:</span> <span class="s1">&#39;14px&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;text-valign&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;data(id)&#39;</span><span class="p">,</span>
                            <span class="p">}},</span>
                            <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;node&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s1">&#39;background-color&#39;</span><span class="p">:</span> <span class="s1">&#39;lightblue&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;shape&#39;</span><span class="p">:</span> <span class="s1">&#39;round-rectangle&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;5em&#39;</span><span class="p">,</span>
                            <span class="p">}},</span>
                            <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;edge[Infores]&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;data(Infores)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;font-size&#39;</span><span class="p">:</span> <span class="s1">&#39;12px&#39;</span><span class="p">,</span>
                            <span class="p">}},</span>
                            <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;edge.directed&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;curve-style&quot;</span><span class="p">:</span> <span class="s2">&quot;bezier&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;target-arrow-shape&quot;</span><span class="p">:</span> <span class="s2">&quot;triangle&quot;</span><span class="p">,</span>
                            <span class="p">}},</span>
                        <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;edge&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;curve-style&quot;</span><span class="p">:</span> <span class="s2">&quot;bezier&quot;</span><span class="p">,</span>
                            <span class="p">}},</span>

                        <span class="p">]</span>

    <span class="n">undirected</span> <span class="o">=</span> <span class="n">ipycytoscape</span><span class="o">.</span><span class="n">CytoscapeWidget</span><span class="p">()</span>
    <span class="n">undirected</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_graph_from_networkx</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
    <span class="n">undirected</span><span class="o">.</span><span class="n">set_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Path&#39;</span><span class="p">,</span> <span class="n">nodeSpacing</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">edgeLengthVal</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">undirected</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">graph_style</span><span class="p">)</span>

    <span class="n">display</span><span class="p">(</span><span class="n">undirected</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_graph_by_API</span><span class="p">(</span><span class="n">for_plot</span><span class="p">):</span>
        
    <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_pandas_edgelist</span><span class="p">(</span><span class="n">for_plot</span><span class="p">,</span> 
                                    <span class="n">source</span><span class="o">=</span><span class="s1">&#39;Subject&#39;</span><span class="p">,</span>
                                    <span class="n">target</span><span class="o">=</span><span class="s1">&#39;Object&#39;</span><span class="p">,</span> 
                                    <span class="n">edge_attr</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;API&quot;</span><span class="p">],</span> 
                                    <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">)</span>


    <span class="n">graph_style</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;node[id]&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="p">{</span>
                                    <span class="s1">&#39;font-family&#39;</span><span class="p">:</span> <span class="s1">&#39;helvetica&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;font-size&#39;</span><span class="p">:</span> <span class="s1">&#39;14px&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;text-valign&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;data(id)&#39;</span><span class="p">,</span>
                            <span class="p">}},</span>
                            <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;node&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s1">&#39;background-color&#39;</span><span class="p">:</span> <span class="s1">&#39;lightblue&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;shape&#39;</span><span class="p">:</span> <span class="s1">&#39;round-rectangle&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;5em&#39;</span><span class="p">,</span>
                            <span class="p">}},</span>
                            <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;edge[API]&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;data(API)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;font-size&#39;</span><span class="p">:</span> <span class="s1">&#39;12px&#39;</span><span class="p">,</span>
                            <span class="p">}},</span>
                            <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;edge.directed&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;curve-style&quot;</span><span class="p">:</span> <span class="s2">&quot;bezier&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;target-arrow-shape&quot;</span><span class="p">:</span> <span class="s2">&quot;triangle&quot;</span><span class="p">,</span>
                            <span class="p">}},</span>
                        <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;edge&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;curve-style&quot;</span><span class="p">:</span> <span class="s2">&quot;bezier&quot;</span><span class="p">,</span>
                            <span class="p">}},</span>

                        <span class="p">]</span>

    <span class="n">undirected</span> <span class="o">=</span> <span class="n">ipycytoscape</span><span class="o">.</span><span class="n">CytoscapeWidget</span><span class="p">()</span>
    <span class="n">undirected</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_graph_from_networkx</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
    <span class="n">undirected</span><span class="o">.</span><span class="n">set_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Path&#39;</span><span class="p">,</span> <span class="n">nodeSpacing</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">edgeLengthVal</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">undirected</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">graph_style</span><span class="p">)</span>

    <span class="n">display</span><span class="p">(</span><span class="n">undirected</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">load_json_template</span><span class="p">():</span>
    <span class="n">query_json_temp</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;query_graph&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;n0&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;ids&quot;</span><span class="p">:[],</span>
                        <span class="s2">&quot;categories&quot;</span><span class="p">:[</span><span class="s2">&quot;biolink:category&quot;</span><span class="p">]</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;n1&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;categories&quot;</span><span class="p">:[</span><span class="s2">&quot;biolink:category&quot;</span><span class="p">]</span>
                <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;e1&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;n0&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;object&quot;</span><span class="p">:</span> <span class="s2">&quot;n1&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;predicates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;biolink:predicates&quot;</span><span class="p">]</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span><span class="p">(</span><span class="n">query_json_temp</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">extract_json</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
    <span class="n">lft</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">lft</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">rgt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="n">lft</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">rgt</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">substr</span> <span class="o">=</span> <span class="n">txt</span><span class="p">[</span><span class="n">lft</span><span class="p">:</span><span class="n">rgt</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">jsn</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">substr</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">jsn</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">rgt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="n">rgt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lft</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">,</span> <span class="n">lft</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>


<span class="k">def</span><span class="w"> </span><span class="nf">TRAPI_json_validation</span><span class="p">(</span><span class="n">query_json_cur_clean</span><span class="p">,</span> <span class="n">ALL_predicates</span><span class="p">,</span> <span class="n">ALL_categories</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;message&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;message is missing&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;query_graph&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;query_graph is missing&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;edges&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;edges is missing&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;e1&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;edges&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;e1 is missing&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;predicates&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="s1">&#39;e1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;predicates is missing&#39;</span><span class="p">)</span>
                    
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="s1">&#39;e1&#39;</span><span class="p">][</span><span class="s1">&#39;predicates&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ALL_predicates</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;predicates is not in the KG&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicates ok!&quot;</span><span class="p">)</span>
                    
                <span class="k">if</span> <span class="s1">&#39;nodes&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nodes is missing&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;n0&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n0 is missing&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s1">&#39;categories&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="s1">&#39;n0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;categories is missing&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="s1">&#39;n0&#39;</span><span class="p">][</span><span class="s1">&#39;categories&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ALL_categories</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;categories is not in the KG&#39;</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;node0 category OK!&quot;</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="s1">&#39;n1&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n1 is missing&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s1">&#39;categories&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="s1">&#39;n1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;categories is missing&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="s1">&#39;n1&#39;</span><span class="p">][</span><span class="s1">&#39;categories&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ALL_categories</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;categories is not in the KG&#39;</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;node1 category OK!&quot;</span><span class="p">)</span>

    <span class="k">return</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">format_id</span><span class="p">(</span><span class="n">query_json_cur_clean</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;ids&#39;</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="s1">&#39;n0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">input_nodes</span> <span class="o">=</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="s1">&#39;n0&#39;</span><span class="p">][</span><span class="s1">&#39;ids&#39;</span><span class="p">]</span>
        <span class="n">input_node1_id</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_nodes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">input_nodes</span><span class="p">:</span>
                <span class="n">input_node1_id</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_curie</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">input_node1_id</span><span class="p">)</span>

        <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="s1">&#39;n0&#39;</span><span class="p">][</span><span class="s1">&#39;ids&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_node1_id</span>

    <span class="k">if</span> <span class="s1">&#39;ids&#39;</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="s1">&#39;n1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">input_nodes2</span> <span class="o">=</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="s1">&#39;n1&#39;</span><span class="p">][</span><span class="s1">&#39;ids&#39;</span><span class="p">]</span>
        <span class="n">input_node2_id</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_nodes2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">input_nodes2</span><span class="p">:</span>
                <span class="n">input_node2_id</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_curie</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">input_node2_id</span><span class="p">)</span>
        <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="s1">&#39;n1&#39;</span><span class="p">][</span><span class="s1">&#39;ids&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_node2_id</span>
    <span class="k">return</span><span class="p">(</span><span class="n">query_json_cur_clean</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">query_chatGPT</span><span class="p">(</span><span class="n">customized_input</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">):</span>
    <span class="n">message</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">customized_input</span><span class="p">}]</span>
    
    <span class="n">response</span> <span class="o">=</span> <span class="n">openai</span><span class="o">.</span><span class="n">chat</span><span class="o">.</span><span class="n">completions</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">max_tokens</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">temperature</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">messages</span><span class="o">=</span><span class="n">message</span><span class="p">,</span>
    <span class="p">)</span>
    
    <span class="c1"># print(len(response.choices[0].message.content.split(&quot; &quot;)))</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span>

<span class="k">def</span><span class="w"> </span><span class="nf">query_chatGPT4</span><span class="p">(</span><span class="n">customized_input</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">query_chatGPT</span><span class="p">(</span><span class="n">customized_input</span><span class="p">,</span> <span class="s2">&quot;gpt-4&quot;</span><span class="p">)</span>
    

<span class="k">def</span><span class="w"> </span><span class="nf">ask_chatGPT</span><span class="p">(</span><span class="n">prompt_text</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">query_chatGPT</span><span class="p">(</span><span class="n">prompt_text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>
        

<span class="k">def</span><span class="w"> </span><span class="nf">ask_chatGPT4</span><span class="p">(</span><span class="n">prompt_text</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">query_chatGPT4</span><span class="p">(</span><span class="n">prompt_text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_similar_predicates</span><span class="p">(</span><span class="n">query_json_cur_clean</span><span class="p">,</span> <span class="n">ALL_predicates</span><span class="p">):</span>
    <span class="n">current_predicates</span> <span class="o">=</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="s1">&#39;e1&#39;</span><span class="p">][</span><span class="s1">&#39;predicates&#39;</span><span class="p">]</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">ask_chatGPT4</span><span class="p">(</span><span class="s2">&quot;The predicates in the KG are: &quot;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ALL_predicates</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;. The predicates in the current query are: &quot;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_predicates</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;. What predicates are similar to the predicates in the current query?&quot;</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_similar_category</span><span class="p">(</span><span class="n">query_json_cur_clean</span><span class="p">,</span> <span class="n">ALL_categories</span><span class="p">):</span>
    <span class="n">current_predicates1</span> <span class="o">=</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="s1">&#39;n0&#39;</span><span class="p">][</span><span class="s1">&#39;categories&#39;</span><span class="p">]</span>
    <span class="n">current_predicates2</span> <span class="o">=</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="s1">&#39;n1&#39;</span><span class="p">][</span><span class="s1">&#39;categories&#39;</span><span class="p">]</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">ask_chatGPT4</span><span class="p">(</span><span class="s2">&quot;The categories in the KG are: &quot;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ALL_categories</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;. The category in the current query are: &quot;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_predicates1</span> <span class="o">+</span> <span class="n">current_predicates2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;. What categories are similar to the categories in the current query?&quot;</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">visulize_path</span><span class="p">(</span><span class="n">input_node1_id</span><span class="p">,</span> <span class="n">intermediate_node</span><span class="p">,</span> <span class="n">input_node3_id</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">result2</span><span class="p">):</span>
    <span class="n">forplot_subject</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">forplot_object</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">forplot_predicate</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">forplot_Infores</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">intermediate_node</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">input_node1_id</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">intermediate_node</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">input_node1_id</span><span class="p">)</span>  <span class="p">:</span>
            <span class="n">forplot_subject</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">])</span>
            <span class="n">forplot_object</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>
            <span class="c1">#forplot_predicate.append(result[k][&#39;predicate&#39;].split(&#39;:&#39;)[1])</span>
            <span class="n">cur_sources_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">sources</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span>
            
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
                <span class="n">cur_source</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;resource_id&#39;</span><span class="p">]</span>
                <span class="n">cur_sources_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cur_source</span><span class="p">)</span>
                
            <span class="n">forplot_Infores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cur_sources_list</span><span class="p">)</span>

            <span class="n">forplot_predicate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;::&quot;</span> <span class="o">+</span> <span class="n">cur_sources_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">result2</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result2</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">intermediate_node</span> <span class="ow">and</span> <span class="n">result2</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">input_node3_id</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">result2</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">intermediate_node</span> <span class="ow">and</span> <span class="n">result2</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">input_node3_id</span><span class="p">)</span>  <span class="p">:</span>
            <span class="n">forplot_subject</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result2</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;subject&#39;</span><span class="p">])</span>
            <span class="n">forplot_object</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result2</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>
            <span class="c1">#forplot_predicate.append(result2[k][&#39;predicate&#39;].split(&#39;:&#39;)[1])</span>
            <span class="n">cur_sources_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">sources</span> <span class="o">=</span> <span class="n">result2</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span>
            
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
                <span class="n">cur_source</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;resource_id&#39;</span><span class="p">]</span>
                <span class="n">cur_sources_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cur_source</span><span class="p">)</span>
                
            <span class="n">forplot_Infores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cur_sources_list</span><span class="p">)</span>
            <span class="n">forplot_predicate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result2</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;predicate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;::&quot;</span> <span class="o">+</span>  <span class="n">cur_sources_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            
    <span class="n">forplot</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Subject&quot;</span><span class="p">:</span><span class="n">forplot_subject</span><span class="p">,</span> <span class="s2">&quot;Object&quot;</span><span class="p">:</span><span class="n">forplot_object</span><span class="p">,</span> <span class="s2">&quot;Predicates&quot;</span><span class="p">:</span><span class="n">forplot_predicate</span><span class="p">})</span>

    <span class="c1"># get preferred name</span>
    <span class="n">subject_name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">forplot</span><span class="p">[</span><span class="s2">&quot;Subject&quot;</span><span class="p">]</span> <span class="p">)</span>
    <span class="n">object_name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">forplot</span><span class="p">[</span><span class="s2">&quot;Object&quot;</span><span class="p">])</span>
    <span class="n">dic_id_map</span> <span class="o">=</span> <span class="n">ID_convert_to_preferred_name_nodeNormalizer</span><span class="p">(</span><span class="n">subject_name</span><span class="o">+</span> <span class="n">object_name</span><span class="p">)</span>
    <span class="n">new_subject_name</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">subject_name</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dic_id_map</span><span class="p">:</span>
            <span class="n">new_subject_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic_id_map</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_subject_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>   

    <span class="n">new_object_name</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">object_name</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dic_id_map</span><span class="p">:</span>
            <span class="n">new_object_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic_id_map</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_object_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>         
    <span class="n">forplot</span><span class="p">[</span><span class="s1">&#39;Subject_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_subject_name</span>
    <span class="n">forplot</span><span class="p">[</span><span class="s1">&#39;Object_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_object_name</span>

    <span class="n">forplot</span> <span class="o">=</span> <span class="n">forplot</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

    <span class="c1"># add two columns for forplot named check1 = Subject_name + &#39;::&#39; + Predicates + &#39;::&#39; + Object_name, and check2 = Object_name + &#39;::&#39; + Predicates + &#39;::&#39; + Subject_name</span>
    <span class="c1"># if check1 is equal to check2, then drop one of them</span>
    <span class="n">forplot</span><span class="p">[</span><span class="s1">&#39;check1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">forplot</span><span class="p">[</span><span class="s1">&#39;Subject_name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;::&#39;</span> <span class="o">+</span> <span class="n">forplot</span><span class="p">[</span><span class="s1">&#39;Predicates&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;::&#39;</span> <span class="o">+</span> <span class="n">forplot</span><span class="p">[</span><span class="s1">&#39;Object_name&#39;</span><span class="p">]</span>
    <span class="n">forplot</span><span class="p">[</span><span class="s1">&#39;check2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">forplot</span><span class="p">[</span><span class="s1">&#39;Object_name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;::&#39;</span> <span class="o">+</span> <span class="n">forplot</span><span class="p">[</span><span class="s1">&#39;Predicates&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;::&#39;</span> <span class="o">+</span> <span class="n">forplot</span><span class="p">[</span><span class="s1">&#39;Subject_name&#39;</span><span class="p">]</span>
    
    <span class="c1"># check if check1 is equal to check2, if so, drop one of them</span>
    <span class="n">to_be_dropped</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">check1_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">forplot</span><span class="p">[</span><span class="s1">&#39;check1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">check2_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">forplot</span><span class="p">[</span><span class="s1">&#39;check2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">check1_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">check1_list</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">check1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">check2_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">and</span> <span class="n">check2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">check1_list</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                <span class="n">to_be_dropped</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">break</span>
                <span class="c1">#break</span>
    <span class="n">to_be_dropped</span>
    <span class="n">forplot</span> <span class="o">=</span> <span class="n">forplot</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">to_be_dropped</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># remove the check1 and check2 columns</span>
    <span class="n">forplot</span> <span class="o">=</span> <span class="n">forplot</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;check1&#39;</span><span class="p">,</span> <span class="s1">&#39;check2&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">forplot</span> <span class="o">=</span> <span class="n">forplot</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_pandas_edgelist</span><span class="p">(</span><span class="n">forplot</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;Subject_name&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;Object_name&#39;</span><span class="p">,</span> <span class="n">edge_attr</span><span class="o">=</span><span class="p">[</span> <span class="s1">&#39;Predicates&#39;</span><span class="p">],</span> <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">MultiGraph</span><span class="p">)</span>
    
    <span class="n">graph_style</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;node[id]&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="p">{</span>
                                  <span class="s1">&#39;font-family&#39;</span><span class="p">:</span> <span class="s1">&#39;Arial&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;font-size&#39;</span><span class="p">:</span> <span class="s1">&#39;12px&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;text-valign&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;data(id)&#39;</span><span class="p">,</span>
                        <span class="p">}},</span>
                        <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;node&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="p">{</span>
                             <span class="s1">&#39;background-color&#39;</span><span class="p">:</span> <span class="s1">&#39;lightblue&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;shape&#39;</span><span class="p">:</span> <span class="s1">&#39;round-rectangle&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;3em&#39;</span><span class="p">,</span>
                         <span class="p">}},</span>
                        <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;edge[Predicates]&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="p">{</span>
                             <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;data(Predicates)&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;font-size&#39;</span><span class="p">:</span> <span class="s1">&#39;8px&#39;</span><span class="p">,</span>
                         <span class="p">}},</span>
                        <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;edge.directed&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;curve-style&quot;</span><span class="p">:</span> <span class="s2">&quot;bezier&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;target-arrow-shape&quot;</span><span class="p">:</span> <span class="s2">&quot;triangle&quot;</span><span class="p">,</span>
                        <span class="p">}},</span>
                       <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;edge&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;curve-style&quot;</span><span class="p">:</span> <span class="s2">&quot;bezier&quot;</span><span class="p">,</span>
                        <span class="p">}},</span>

                    <span class="p">]</span>
    <span class="n">pathgraph</span> <span class="o">=</span> <span class="n">ipycytoscape</span><span class="o">.</span><span class="n">CytoscapeWidget</span><span class="p">()</span>
    <span class="n">pathgraph</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_graph_from_networkx</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
    <span class="n">pathgraph</span><span class="o">.</span><span class="n">set_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Path&#39;</span><span class="p">,</span> <span class="n">nodeSpacing</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">edgeLengthVal</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">pathgraph</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">graph_style</span><span class="p">)</span>

    <span class="n">display</span><span class="p">(</span><span class="n">pathgraph</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">forplot</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_similar_category</span><span class="p">(</span><span class="n">query_json_cur_clean</span><span class="p">,</span> <span class="n">KG_category</span><span class="p">):</span>
    <span class="n">similar_category_text</span> <span class="o">=</span> <span class="n">find_similar_category</span><span class="p">(</span><span class="n">query_json_cur_clean</span><span class="p">,</span> <span class="n">KG_category</span><span class="p">)</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">similar_category_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="n">similar_category</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;biolink:&#39;</span><span class="p">)</span> <span class="p">:</span>
            <span class="n">potential_similar_category</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">potential_similar_category</span> <span class="ow">in</span> <span class="n">KG_category</span><span class="p">:</span>
                <span class="n">similar_category</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">potential_similar_category</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="s1">&#39;n0&#39;</span><span class="p">][</span><span class="s1">&#39;categories&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">KG_category</span><span class="p">:</span>
            <span class="n">similar_category</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">category</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="s1">&#39;n1&#39;</span><span class="p">][</span><span class="s1">&#39;categories&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">KG_category</span><span class="p">:</span>
            <span class="n">similar_category</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">category</span><span class="p">)</span>

    <span class="n">similar_category</span> <span class="o">=</span> <span class="n">similar_category</span> <span class="o">+</span> <span class="n">KG_category</span>

    <span class="k">return</span> <span class="n">similar_category</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_similar_predicate</span><span class="p">(</span><span class="n">query_json_cur_clean</span><span class="p">,</span> <span class="n">All_predicates</span><span class="p">):</span>
    <span class="n">similar_predicate_text</span> <span class="o">=</span> <span class="n">find_similar_predicates</span><span class="p">(</span><span class="n">query_json_cur_clean</span><span class="p">,</span> <span class="n">All_predicates</span><span class="p">)</span>
    <span class="n">similar_predicate_text</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">similar_predicate_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">cur_words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">words</span> <span class="o">+</span> <span class="n">cur_words</span>
    <span class="n">similar_predicate</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;biolink:&#39;</span><span class="p">)</span> <span class="p">:</span>
            <span class="n">similar_predicate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">predicate</span> <span class="ow">in</span> <span class="n">query_json_cur_clean</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;query_graph&#39;</span><span class="p">][</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="s1">&#39;e1&#39;</span><span class="p">][</span><span class="s1">&#39;predicates&#39;</span><span class="p">]:</span>
        <span class="n">similar_predicate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span>

    <span class="n">similar_predicate</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">similar_predicate</span><span class="p">))</span>

    <span class="n">similar_predicate</span>
    <span class="k">return</span> <span class="n">similar_predicate</span>


<span class="c1"># I&#39;ve added this code so I could test ID_convert_to_preferred_name_nodeNormalizer()</span>
<span class="c1"># without changing any of the rest of the code. Please delete it once you understand</span>
<span class="c1"># the other changes I&#39;ve made!</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Check function on some identifier lists.</span>
    <span class="n">result1</span> <span class="o">=</span> <span class="n">ID_convert_to_preferred_name_nodeNormalizer</span><span class="p">([])</span>
    <span class="k">if</span> <span class="n">result1</span> <span class="o">!=</span> <span class="p">{}:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ID_convert_to_preferred_name_nodeNormalizer([]) should equal []&quot;</span><span class="p">)</span>

    <span class="n">result2</span> <span class="o">=</span> <span class="n">ID_convert_to_preferred_name_nodeNormalizer</span><span class="p">([</span><span class="s1">&#39;UBERON:0000201&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">result2</span> <span class="o">!=</span> <span class="p">{</span><span class="s1">&#39;UBERON:0000201&#39;</span><span class="p">:</span> <span class="s1">&#39;endothelial blood brain barrier&#39;</span><span class="p">}:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Incorrect result: </span><span class="si">{</span><span class="n">result2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">result3</span> <span class="o">=</span> <span class="n">ID_convert_to_preferred_name_nodeNormalizer</span><span class="p">([</span><span class="s1">&#39;MESH:D005183&#39;</span><span class="p">,</span> <span class="s1">&#39;UBERON:0000201&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">result3</span> <span class="o">!=</span> <span class="p">{</span>
        <span class="s1">&#39;UBERON:0000201&#39;</span><span class="p">:</span> <span class="s1">&#39;endothelial blood brain barrier&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MESH:D005183&#39;</span><span class="p">:</span> <span class="s1">&#39;Failure to Thrive&#39;</span>
    <span class="p">}:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Incorrect result: </span><span class="si">{</span><span class="n">result3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">result4</span> <span class="o">=</span> <span class="n">ID_convert_to_preferred_name_nodeNormalizer</span><span class="p">([</span><span class="s1">&#39;CHEBI:45863&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:31703&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">result4</span> <span class="o">!=</span> <span class="p">{</span>
        <span class="s1">&#39;CHEBI:45863&#39;</span><span class="p">:</span> <span class="s1">&#39;Paclitaxel&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:31703&#39;</span><span class="p">:</span> <span class="s1">&#39;Doxorubicin&#39;</span>
    <span class="p">}:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Incorrect result: </span><span class="si">{</span><span class="n">result4</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">result5</span> <span class="o">=</span> <span class="n">ID_convert_to_preferred_name_nodeNormalizer</span><span class="p">([</span>
        <span class="s1">&#39;RXCUI:258355&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:4261&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:49850262&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:50992434&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:135539077&#39;</span><span class="p">,</span>
        <span class="s1">&#39;RXCUI:1430268&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CHEBI:90942&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CHEBI:110200&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CHEBI:63996&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CHEBI:6716&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CHEBI:14222&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:25141092&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:36314&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:31703&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3385&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:126941&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:135410875&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:148124&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5311497&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:107935&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:387447&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:518605&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5282165&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5591&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1322&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:95170&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2286&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1242&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:8461&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:11813&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1530&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:11831&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:7577&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:73864&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:4521392&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:47289&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1983&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:12035&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:449459&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:186907&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:449171&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:7290&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2236&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5359596&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6918483&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:23667548&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2256&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:62306&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2336&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6623&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:66166&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:12111&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6626&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:16682746&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5360373&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:7961&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2478&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:264&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:23973&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2519&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5280453&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5943&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1203&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:135411&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:154413&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:40470&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2730&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:29131&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:9171&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5702198&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2797&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:24463&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:323&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:40585&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:451668&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:40024&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3017&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3026&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5371560&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:969491&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:8343&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5921&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:448537&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6124&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:8346&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5757&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:702&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5991&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:11&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3346&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3397&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:135398658&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:14101198&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:104741&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:8029&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:60750&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5280961&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:9898639&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:637566&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3474&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:23985&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3616&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:42890&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3715&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6912226&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3779&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:9812710&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:46907787&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:25195294&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:896&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:10836&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:4098&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:13709&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1349907&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1674&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:4156&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:7456&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6010&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:8575&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:4449&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:4122&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:442530&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:9887053&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:991&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:854&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:74483&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:9554&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5794&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5694&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:15032&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:657298&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:14942&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5280343&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5035&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6758&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5186&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1091&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:133538&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:7305&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5323&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5329102&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5284461&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:24857286&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6410&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5995&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6618&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:15625&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:27924&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2723949&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:26042&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:60700&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:444795&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6575&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5564&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:11089&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:65411&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:23964&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3121&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:14969&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:39676&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2116&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MESH:D014874&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:23994&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:11626560&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:57379345&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5328940&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:49846579&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:25134326&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:9829523&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:25183872&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:49806720&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:71731823&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5311&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5281855&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5291&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:135430309&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:447077&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5284616&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:11707110&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:10184653&#39;</span><span class="p">,</span>
        <span class="s1">&#39;TTD.DRUG:D0Z1OR&#39;</span><span class="p">,</span>
        <span class="s1">&#39;UNII:334895S862&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:176870&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6049&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:440473&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:175&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:457193&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1548943&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:36462&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5281672&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6057&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:78165&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6518&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5360696&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6253&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:30323&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2733526&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3108&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:10366136&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3220&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:7405&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:656894&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:10607&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:135398748&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:8771&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:679&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6918638&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:44259&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:444732&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6029&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:34755&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5284627&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5957&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2353&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:72277&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:46191454&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:8988&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:977&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DRUGBANK:DB12182&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:23725625&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:4212&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:91766&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:65359&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:441923&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:445154&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:65064&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:11338033&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:9444&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:30751&#39;</span>
    <span class="p">])</span>
    <span class="k">if</span> <span class="n">result5</span> <span class="o">!=</span> <span class="p">{</span>
        <span class="s1">&#39;RXCUI:258355&#39;</span><span class="p">:</span> <span class="s1">&#39;Rapamune&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:4261&#39;</span><span class="p">:</span> <span class="s1">&#39;Entinostat&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:49850262&#39;</span><span class="p">:</span> <span class="s1">&#39;Tubastatin A&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:50992434&#39;</span><span class="p">:</span> <span class="s1">&#39;Trametinib dimethyl sulfoxide&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:135539077&#39;</span><span class="p">:</span> <span class="s1">&#39;Luminespib&#39;</span><span class="p">,</span>
        <span class="s1">&#39;RXCUI:1430268&#39;</span><span class="p">:</span> <span class="s1">&#39;Gilotrif&#39;</span><span class="p">,</span> <span class="s1">&#39;CHEBI:90942&#39;</span><span class="p">:</span> <span class="s1">&#39;Ixazomib&#39;</span><span class="p">,</span> <span class="s1">&#39;CHEBI:110200&#39;</span><span class="p">:</span> <span class="s1">&#39;CHEBI:110200&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CHEBI:63996&#39;</span><span class="p">:</span> <span class="s1">&#39;SKF 83959 hydrobromide&#39;</span><span class="p">,</span> <span class="s1">&#39;CHEBI:6716&#39;</span><span class="p">:</span> <span class="s1">&#39;Medroxyprogesterone acetate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CHEBI:14222&#39;</span><span class="p">:</span> <span class="s1">&#39;CHEBI:14222&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:25141092&#39;</span><span class="p">:</span> <span class="s1">&#39;Entrectinib&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:36314&#39;</span><span class="p">:</span> <span class="s1">&#39;Paclitaxel&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:31703&#39;</span><span class="p">:</span> <span class="s1">&#39;Doxorubicin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3385&#39;</span><span class="p">:</span> <span class="s1">&#39;Fluorouracil&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:126941&#39;</span><span class="p">:</span> <span class="s1">&#39;Methotrexate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:135410875&#39;</span><span class="p">:</span> <span class="s1">&#39;Pemetrexed&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:148124&#39;</span><span class="p">:</span> <span class="s1">&#39;Docetaxel&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5311497&#39;</span><span class="p">:</span> <span class="s1">&#39;Vinorelbine&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:107935&#39;</span><span class="p">:</span> <span class="s1">&#39;Deguelin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:387447&#39;</span><span class="p">:</span> <span class="s1">&#39;Bortezomib&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:518605&#39;</span><span class="p">:</span> <span class="s1">&#39;2,4,6,8,9,10-Hexaoxa-1,3,5,7-tetraarsatricyclo[3.3.1.13,7]decane&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5282165&#39;</span><span class="p">:</span> <span class="s1">&#39;Josamycin&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5591&#39;</span><span class="p">:</span> <span class="s1">&#39;Troglitazone&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1322&#39;</span><span class="p">:</span> <span class="s1">&#39;1,2-Dimethylhydrazine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:95170&#39;</span><span class="p">:</span> <span class="s2">&quot;2,2&#39;,4,4&#39;-Tetrabromodiphenyl ether&quot;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2286&#39;</span><span class="p">:</span> <span class="s1">&#39;Bisphenol A diglycidyl ether&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1242&#39;</span><span class="p">:</span> <span class="s1">&#39;2,3,4,5-Tetrahydro-7,8-dihydroxy-1-phenyl-1H-3-benzazepine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:8461&#39;</span><span class="p">:</span> <span class="s1">&#39;2,4-Dinitrotoluene&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:11813&#39;</span><span class="p">:</span> <span class="s1">&#39;2,6-Dinitrotoluene&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1530&#39;</span><span class="p">:</span> <span class="s1">&#39;2-Amino-1-methyl-6-phenylimidazo(4,5-b)pyridine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:11831&#39;</span><span class="p">:</span> <span class="s1">&#39;2-Nitrofluorene&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:7577&#39;</span><span class="p">:</span> <span class="s2">&quot;4,4&#39;-Methylenedianiline&quot;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:73864&#39;</span><span class="p">:</span> <span class="s1">&#39;Bisphenol AF&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:4521392&#39;</span><span class="p">:</span> <span class="s1">&#39;4-(4-(benzo[d][1,3]dioxol-5-yl)-5-(pyridin-2-yl)-1H-imidazol-2-yl)benzamide&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:47289&#39;</span><span class="p">:</span> <span class="s1">&#39;4-(N-Nitrosomethylamino)-1-(3-pyridyl)-1-butanone&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1983&#39;</span><span class="p">:</span> <span class="s1">&#39;Acetaminophen&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:12035&#39;</span><span class="p">:</span> <span class="s1">&#39;Acetylcysteine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:449459&#39;</span><span class="p">:</span> <span class="s1">&#39;Afimoxifene&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:186907&#39;</span><span class="p">:</span> <span class="s1">&#39;Aflatoxin B1&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:449171&#39;</span><span class="p">:</span> <span class="s1">&#39;Alitretinoin&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:7290&#39;</span><span class="p">:</span> <span class="s1">&#39;3-Chloro-1,2-propanediol&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2236&#39;</span><span class="p">:</span> <span class="s1">&#39;Aristolochic acid&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5359596&#39;</span><span class="p">:</span> <span class="s1">&#39;Arsenic&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6918483&#39;</span><span class="p">:</span> <span class="s1">&#39;Artenimol&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:23667548&#39;</span><span class="p">:</span> <span class="s1">&#39;Sodium Ascorbate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2256&#39;</span><span class="p">:</span> <span class="s1">&#39;Atrazine&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:62306&#39;</span><span class="p">:</span> <span class="s1">&#39;Benoxacor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2336&#39;</span><span class="p">:</span> <span class="s1">&#39;Benzo[a]pyrene&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:6623&#39;</span><span class="p">:</span> <span class="s1">&#39;Bisphenol A&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:66166&#39;</span><span class="p">:</span> <span class="s1">&#39;Bisphenol B&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:12111&#39;</span><span class="p">:</span> <span class="s2">&quot;4,4&#39;-Methylenediphenol&quot;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6626&#39;</span><span class="p">:</span> <span class="s2">&quot;4,4&#39;-Sulfonyldiphenol&quot;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:16682746&#39;</span><span class="p">:</span> <span class="s1">&#39;Tributyltin oxide&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5360373&#39;</span><span class="p">:</span> <span class="s1">&#39;Bleomycin&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:7961&#39;</span><span class="p">:</span> <span class="s1">&#39;Bromobenzene&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2478&#39;</span><span class="p">:</span> <span class="s1">&#39;Busulfan&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:264&#39;</span><span class="p">:</span> <span class="s1">&#39;Butyric Acid&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:23973&#39;</span><span class="p">:</span> <span class="s1">&#39;Cadmium&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:2519&#39;</span><span class="p">:</span> <span class="s1">&#39;Caffeine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5280453&#39;</span><span class="p">:</span> <span class="s1">&#39;Calcitriol&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5943&#39;</span><span class="p">:</span> <span class="s1">&#39;Carbon Tetrachloride&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1203&#39;</span><span class="p">:</span> <span class="s1">&#39;2-(3,4-Dihydroxyphenyl)chroman-3,5,7-triol&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:135411&#39;</span><span class="p">:</span> <span class="s1">&#39;6-[3-(1-Adamantyl)-4-hydroxyphenyl]-2-naphthalenecarboxylic Acid&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:154413&#39;</span><span class="p">:</span> <span class="s1">&#39;Centchroman&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:40470&#39;</span><span class="p">:</span> <span class="s2">&quot;2,2&#39;,3,3&#39;,4-Pentachlorobiphenyl&quot;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2730&#39;</span><span class="p">:</span> <span class="s1">&#39;Chlorpyrifos&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:29131&#39;</span><span class="p">:</span> <span class="s1">&#39;Chromium(6+)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:9171&#39;</span><span class="p">:</span> <span class="s1">&#39;Chrysene&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5702198&#39;</span><span class="p">:</span> <span class="s1">&#39;azane;dichloroplatinum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2797&#39;</span><span class="p">:</span> <span class="s1">&#39;Clofibric acid&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:24463&#39;</span><span class="p">:</span> <span class="s1">&#39;Copper sulfate pentahydrate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:323&#39;</span><span class="p">:</span> <span class="s1">&#39;Coumarin&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:40585&#39;</span><span class="p">:</span> <span class="s1">&#39;Deltamethrin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:451668&#39;</span><span class="p">:</span> <span class="s1">&#39;Decitabine&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:40024&#39;</span><span class="p">:</span> <span class="s1">&#39;Deoxynivalenol&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3017&#39;</span><span class="p">:</span> <span class="s1">&#39;Diazinon&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:3026&#39;</span><span class="p">:</span> <span class="s1">&#39;Dibutyl Phthalate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5371560&#39;</span><span class="p">:</span> <span class="s1">&#39;Dicrotophos&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:969491&#39;</span><span class="p">:</span> <span class="s1">&#39;Dieldrin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:8343&#39;</span><span class="p">:</span> <span class="s1">&#39;Bis(2-ethylhexyl) phthalate&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5921&#39;</span><span class="p">:</span> <span class="s1">&#39;N-Nitrosodiethylamine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:448537&#39;</span><span class="p">:</span> <span class="s1">&#39;Diethylstilbestrol&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:6124&#39;</span><span class="p">:</span> <span class="s1">&#39;N-Nitrosodimethylamine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:8346&#39;</span><span class="p">:</span> <span class="s1">&#39;Dioctyl phthalate&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5757&#39;</span><span class="p">:</span> <span class="s1">&#39;Estradiol&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:702&#39;</span><span class="p">:</span> <span class="s1">&#39;Ethanol&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5991&#39;</span><span class="p">:</span> <span class="s1">&#39;Ethinyl estradiol&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:11&#39;</span><span class="p">:</span> <span class="s1">&#39;1,2-Dichloroethane&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:3346&#39;</span><span class="p">:</span> <span class="s1">&#39;Fenthion&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3397&#39;</span><span class="p">:</span> <span class="s1">&#39;Flutamide&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:135398658&#39;</span><span class="p">:</span> <span class="s1">&#39;Folic Acid&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:14101198&#39;</span><span class="p">:</span> <span class="s1">&#39;[(1R)-1-[(3S,6S,9S,12S,18R,21S,22R)-21-acetamido-18-benzyl-3-[(1R)-1-methoxyethyl]-4,9,10,12,16-pentamethyl-15-methylidene-2,5,8,11,14,17,20-heptaoxo-22-propan-2-yl-1,19-dioxa-4,7,10,13,16-pentazacyclodocos-6-yl]-2-methylpropyl] (2S,3R)-3-hydroxy-4-methyl-2-(propanoylamino)pentanoate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:104741&#39;</span><span class="p">:</span> <span class="s1">&#39;Fulvestrant&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:8029&#39;</span><span class="p">:</span> <span class="s1">&#39;Furan&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:60750&#39;</span><span class="p">:</span> <span class="s1">&#39;Gemcitabine&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5280961&#39;</span><span class="p">:</span> <span class="s1">&#39;Genistein&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:9898639&#39;</span><span class="p">:</span> <span class="s1">&#39;Gentamicinsulfate salt&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:637566&#39;</span><span class="p">:</span> <span class="s1">&#39;Geraniol&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3474&#39;</span><span class="p">:</span> <span class="s1">&#39;Glafenine&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:23985&#39;</span><span class="p">:</span> <span class="s1">&#39;Gold&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3616&#39;</span><span class="p">:</span> <span class="s1">&#39;Hexamethylene bisacetamide&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:42890&#39;</span><span class="p">:</span> <span class="s1">&#39;Idarubicin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3715&#39;</span><span class="p">:</span> <span class="s1">&#39;Indomethacin&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:6912226&#39;</span><span class="p">:</span> <span class="s1">&#39;Ionomycin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3779&#39;</span><span class="p">:</span> <span class="s1">&#39;Isoproterenol&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:9812710&#39;</span><span class="p">:</span> <span class="s1">&#39;Ivermectine 100 microg/mL in Acetonitrile&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:46907787&#39;</span><span class="p">:</span> <span class="s1">&#39;(S)-(+)-tert-Butyl 2-(4-(4-chlorophenyl)-2,3,9-trimethyl-6H-thieno(3,2-f)(1,2,4)triazolo(4,3-a)(1,4)diazepin-6-yl)acetate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:25195294&#39;</span><span class="p">:</span> <span class="s1">&#39;4-(6-(4-(Piperazin-1-yl)phenyl)pyrazolo[1,5-a]pyrimidin-3-yl)quinoline&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:896&#39;</span><span class="p">:</span> <span class="s1">&#39;Melatonin&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:10836&#39;</span><span class="p">:</span> <span class="s1">&#39;Methamphetamine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:4098&#39;</span><span class="p">:</span> <span class="s1">&#39;Methapyrilene&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:13709&#39;</span><span class="p">:</span> <span class="s1">&#39;Methidathion&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1349907&#39;</span><span class="p">:</span> <span class="s1">&#39;Methimazole&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:1674&#39;</span><span class="p">:</span> <span class="s1">&#39;3-Methylcholanthrene&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:4156&#39;</span><span class="p">:</span> <span class="s1">&#39;Methyl methanesulfonate&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:7456&#39;</span><span class="p">:</span> <span class="s1">&#39;Methylparaben&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6010&#39;</span><span class="p">:</span> <span class="s1">&#39;Methyltestosterone&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:8575&#39;</span><span class="p">:</span> <span class="s1">&#39;Monobutyl phthalate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:4449&#39;</span><span class="p">:</span> <span class="s1">&#39;Nefazodone&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:4122&#39;</span><span class="p">:</span> <span class="s1">&#39;Nocodazole&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:442530&#39;</span><span class="p">:</span> <span class="s1">&#39;Ochratoxin A&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:9887053&#39;</span><span class="p">:</span> <span class="s1">&#39;Oxaliplatin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:991&#39;</span><span class="p">:</span> <span class="s1">&#39;Parathion&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:854&#39;</span><span class="p">:</span> <span class="s1">&#39;DL-Arabinose&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:74483&#39;</span><span class="p">:</span> <span class="s1">&#39;Perfluorooctanesulfonic acid&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:9554&#39;</span><span class="p">:</span> <span class="s1">&#39;Perfluorooctanoic acid&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5794&#39;</span><span class="p">:</span> <span class="s1">&#39;Piperonyl butoxide&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5694&#39;</span><span class="p">:</span> <span class="s1">&#39;Pirinixic acid&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:15032&#39;</span><span class="p">:</span> <span class="s1">&#39;Pregnenolone carbonitrile&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:657298&#39;</span><span class="p">:</span> <span class="s1">&#39;Propylthiouracil&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:14942&#39;</span><span class="p">:</span> <span class="s1">&#39;Orthosilicic acid&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5280343&#39;</span><span class="p">:</span> <span class="s1">&#39;Quercetin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5035&#39;</span><span class="p">:</span> <span class="s1">&#39;Raloxifene&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:6758&#39;</span><span class="p">:</span> <span class="s1">&#39;Rotenone&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5186&#39;</span><span class="p">:</span> <span class="s1">&#39;Scriptaid&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:1091&#39;</span><span class="p">:</span> <span class="s1">&#39;Selenious acid&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:133538&#39;</span><span class="p">:</span> <span class="s1">&#39;3-Methyl-6-chloro-2,3,4,5-tetrahydro-7,8-dihydroxy-1-(3-methylphenyl)-1H-3-benzazepine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:7305&#39;</span><span class="p">:</span> <span class="s1">&#39;Soman&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5323&#39;</span><span class="p">:</span> <span class="s1">&#39;Sulfadimethoxine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5329102&#39;</span><span class="p">:</span> <span class="s1">&#39;Sunitinib&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5284461&#39;</span><span class="p">:</span> <span class="s1">&#39;T-2 Toxin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:24857286&#39;</span><span class="p">:</span> <span class="s1">&#39;Fasiglifam&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:6410&#39;</span><span class="p">:</span> <span class="s1">&#39;tert-Butyl Hydroperoxide&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5995&#39;</span><span class="p">:</span> <span class="s1">&#39;Testosterone propionate&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:6618&#39;</span><span class="p">:</span> <span class="s1">&#39;Tetrabromobisphenol A&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:15625&#39;</span><span class="p">:</span> <span class="s1">&#39;2,3,7,8-Tetrachlorodibenzo-P-dioxin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:27924&#39;</span><span class="p">:</span> <span class="s1">&#39;Phorbol 12-myristate 13-acetate&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:2723949&#39;</span><span class="p">:</span> <span class="s1">&#39;Thioacetamide&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:26042&#39;</span><span class="p">:</span> <span class="s1">&#39;Titanium Dioxide&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:60700&#39;</span><span class="p">:</span> <span class="s1">&#39;Topotecan&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:444795&#39;</span><span class="p">:</span> <span class="s1">&#39;Tretinoin&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:6575&#39;</span><span class="p">:</span> <span class="s1">&#39;Trichloroethylene&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5564&#39;</span><span class="p">:</span> <span class="s1">&#39;Triclosan&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:11089&#39;</span><span class="p">:</span> <span class="s1">&#39;Trimellitic anhydride&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:65411&#39;</span><span class="p">:</span> <span class="s1">&#39;Triptonide&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:23964&#39;</span><span class="p">:</span> <span class="s1">&#39;Tungsten&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:3121&#39;</span><span class="p">:</span> <span class="s1">&#39;Valproic Acid&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:14969&#39;</span><span class="p">:</span> <span class="s1">&#39;Vancomycin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:39676&#39;</span><span class="p">:</span> <span class="s1">&#39;Vinclozolin&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:2116&#39;</span><span class="p">:</span> <span class="s1">&#39;DL-alpha-Tocopherol&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MESH:D014874&#39;</span><span class="p">:</span> <span class="s1">&#39;MESH:D014874&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:23994&#39;</span><span class="p">:</span> <span class="s1">&#39;Zinc&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:11626560&#39;</span><span class="p">:</span> <span class="s1">&#39;Crizotinib&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:57379345&#39;</span><span class="p">:</span> <span class="s1">&#39;Ceritinib&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5328940&#39;</span><span class="p">:</span> <span class="s1">&#39;Bosutinib&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:49846579&#39;</span><span class="p">:</span> <span class="s1">&#39;Venetoclax&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:25134326&#39;</span><span class="p">:</span> <span class="s1">&#39;N2-[2-Methoxy-4-[4-(4-methyl-1-piperazinyl)-1-piperidinyl]phenyl]-N4-[2-[(1-methylethyl)sulfonyl]phenyl]-1,3,5-triazine-2,4-diamine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:9829523&#39;</span><span class="p">:</span> <span class="s1">&#39;Midostaurin&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:25183872&#39;</span><span class="p">:</span> <span class="s1">&#39;Ixazomib&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:49806720&#39;</span><span class="p">:</span> <span class="s1">&#39;Alectinib&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:71731823&#39;</span><span class="p">:</span> <span class="s1">&#39;Lorlatinib&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5311&#39;</span><span class="p">:</span> <span class="s1">&#39;Vorinostat&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5281855&#39;</span><span class="p">:</span> <span class="s1">&#39;Ellagic Acid&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5291&#39;</span><span class="p">:</span> <span class="s1">&#39;Imatinib&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:135430309&#39;</span><span class="p">:</span> <span class="s1">&#39;2-(4-methoxyphenyl)-1H-quinazolin-4-one&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:447077&#39;</span><span class="p">:</span> <span class="s1">&#39;6-(2,6-dichlorophenyl)-8-methyl-2-((3-(methylthio)phenyl)amino)pyrido[2,3-d]pyrimidin-7(8H)-one&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5284616&#39;</span><span class="p">:</span> <span class="s1">&#39;Sirolimus&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:11707110&#39;</span><span class="p">:</span> <span class="s1">&#39;Trametinib&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:10184653&#39;</span><span class="p">:</span> <span class="s1">&#39;Afatinib&#39;</span><span class="p">,</span> <span class="s1">&#39;TTD.DRUG:D0Z1OR&#39;</span><span class="p">:</span> <span class="s1">&#39;TTD.DRUG:D0Z1OR&#39;</span><span class="p">,</span>
        <span class="s1">&#39;UNII:334895S862&#39;</span><span class="p">:</span> <span class="s1">&#39;DOXYCYCLINE ANHYDROUS&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:176870&#39;</span><span class="p">:</span> <span class="s1">&#39;Erlotinib&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6049&#39;</span><span class="p">:</span> <span class="s1">&#39;Edetic Acid&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:440473&#39;</span><span class="p">:</span> <span class="s1">&#39;L-mimosine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:175&#39;</span><span class="p">:</span> <span class="s1">&#39;Acetate&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:457193&#39;</span><span class="p">:</span> <span class="s1">&#39;Dactinomycin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:1548943&#39;</span><span class="p">:</span> <span class="s1">&#39;Capsaicin&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:36462&#39;</span><span class="p">:</span> <span class="s1">&#39;Etoposide&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5281672&#39;</span><span class="p">:</span> <span class="s1">&#39;Myricetin&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:6057&#39;</span><span class="p">:</span> <span class="s1">&#39;Tyrosine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:78165&#39;</span><span class="p">:</span> <span class="s1">&#39;2-(N-Morpholino)-ethanesulfonic acid&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6518&#39;</span><span class="p">:</span> <span class="s1">&#39;Pentaerythritol tetranitrate&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5360696&#39;</span><span class="p">:</span> <span class="s1">&#39;Dextromethorphan&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6253&#39;</span><span class="p">:</span> <span class="s1">&#39;Cytarabine&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:30323&#39;</span><span class="p">:</span> <span class="s1">&#39;Daunorubicin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2733526&#39;</span><span class="p">:</span> <span class="s1">&#39;Tamoxifen&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:3108&#39;</span><span class="p">:</span> <span class="s1">&#39;Dipyridamole&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:10366136&#39;</span><span class="p">:</span> <span class="s1">&#39;Crenolanib&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:3220&#39;</span><span class="p">:</span> <span class="s1">&#39;Emodin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:7405&#39;</span><span class="p">:</span> <span class="s1">&#39;L-Pyroglutamic acid&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:656894&#39;</span><span class="p">:</span> <span class="s1">&#39;Isopropyl-beta-D-thiogalactopyranoside&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:10607&#39;</span><span class="p">:</span> <span class="s1">&#39;Podofilox&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:135398748&#39;</span><span class="p">:</span> <span class="s1">&#39;Penciclovir&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:8771&#39;</span><span class="p">:</span> <span class="s1">&#39;Tetradecyl hydrogen sulfate (ester)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:679&#39;</span><span class="p">:</span> <span class="s1">&#39;Dimethyl Sulfoxide&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:6918638&#39;</span><span class="p">:</span> <span class="s1">&#39;Belinostat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:44259&#39;</span><span class="p">:</span> <span class="s1">&#39;Staurosporine&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:444732&#39;</span><span class="p">:</span> <span class="s1">&#39;trichostatin A&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:6029&#39;</span><span class="p">:</span> <span class="s1">&#39;Uridine&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:34755&#39;</span><span class="p">:</span> <span class="s1">&#39;S-adenosylmethionine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:5284627&#39;</span><span class="p">:</span> <span class="s1">&#39;Topiramate&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:5957&#39;</span><span class="p">:</span> <span class="s2">&quot;Adenosine-5&#39;-triphosphate&quot;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:2353&#39;</span><span class="p">:</span> <span class="s1">&#39;Berberine&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:72277&#39;</span><span class="p">:</span> <span class="s1">&#39;Epigallocatechin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:46191454&#39;</span><span class="p">:</span> <span class="s1">&#39;N-(6,6-dimethyl-5-(1-methylpiperidine-4-carbonyl)-1,4,5,6-tetrahydropyrrolo[3,4-c]pyrazol-3-yl)-3-methylbutanamide&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:8988&#39;</span><span class="p">:</span> <span class="s1">&#39;D-proline&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:977&#39;</span><span class="p">:</span> <span class="s1">&#39;Oxygen&#39;</span><span class="p">,</span> <span class="s1">&#39;DRUGBANK:DB12182&#39;</span><span class="p">:</span> <span class="s1">&#39;DRUGBANK:DB12182&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:23725625&#39;</span><span class="p">:</span> <span class="s1">&#39;Olaparib&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:4212&#39;</span><span class="p">:</span> <span class="s1">&#39;Mitoxantrone&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:91766&#39;</span><span class="p">:</span> <span class="s1">&#39;Flufenoxuron&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:65359&#39;</span><span class="p">:</span> <span class="s1">&#39;Oxiglutatione&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:441923&#39;</span><span class="p">:</span> <span class="s1">&#39;Ginsenoside Rg1&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:445154&#39;</span><span class="p">:</span> <span class="s1">&#39;Resveratrol&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:65064&#39;</span><span class="p">:</span> <span class="s1">&#39;Epigallocatechin Gallate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:11338033&#39;</span><span class="p">:</span> <span class="s1">&#39;4-(2,6-dichlorobenzamido)-N-(piperidin-4-yl)-1H-pyrazole-3-carboxamide&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PUBCHEM.COMPOUND:9444&#39;</span><span class="p">:</span> <span class="s1">&#39;Azacitidine&#39;</span><span class="p">,</span> <span class="s1">&#39;PUBCHEM.COMPOUND:30751&#39;</span><span class="p">:</span> <span class="s1">&#39;Fludarabine phosphate&#39;</span>
    <span class="p">}:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Incorrect result: </span><span class="si">{</span><span class="n">result5</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Test get_curie() too while we&#39;re at it.</span>
    <span class="n">result6</span> <span class="o">=</span> <span class="n">get_curie</span><span class="p">(</span><span class="s1">&#39;BRCA1&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result6</span> <span class="o">!=</span> <span class="s1">&#39;NCBIGene:672&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Searching &#39;BRCA1&#39; on NameLookup does not return NCBIGene:672 as expected but </span><span class="si">{</span><span class="n">result6</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Translator Component Toolkit</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../components.html">Translator Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../name_resolver.html">TCT.name_resolver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../node_normalizer.html">TCT.node_normalizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translator_kpinfo.html">TCT.translator_kpinfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translator_metakg.html">TCT.translator_metakg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translator_query.html">TCT.translator_query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translator_node.html">TCT.translator_node</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TCT.html">TCT utility functions</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Guangrong Qin, Yue Zhang.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>